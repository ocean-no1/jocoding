<!DOCTYPE html>
<html lang="ko">

<head>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <!-- Microsoft Clarity -->
    <script type="text/javascript">
        (function (c, l, a, r, i, t, y) {
            c[a] = c[a] || function () { (c[a].q = c[a].q || []).push(arguments) };
            t = l.createElement(r); t.async = 1; t.src = "https://www.clarity.ms/tag/" + i;
            y = l.getElementsByTagName(r)[0]; y.parentNode.insertBefore(t, y);
        })(window, document, "clarity", "script", "v5iipvten3");
    </script>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VZLKFEGD77"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-VZLKFEGD77');
    </script>

    <!-- JSON-LD Structured Data for Map -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Map",
      "name": "ì „êµ­ ë¡œë˜ ëª…ë‹¹ ì§€ë„",
      "description": "ì „êµ­ ì£¼ìš” ë¡œë˜ 1ë“± ë‹¹ì²¨ì ì˜ ìœ„ì¹˜ì™€ ë‹¹ì²¨ ê¸°ë¡ì„ ë³´ì—¬ì£¼ëŠ” ì¸í„°ë™í‹°ë¸Œ ì§€ë„ì…ë‹ˆë‹¤.",
      "url": "https://publiclensk.org/map.html",
      "provider": {
        "@type": "Organization",
        "name": "PublicLensk",
        "url": "https://publiclensk.org"
      }
    }
    </script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5482753613081557"
        crossorigin="anonymous"></script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì£¼ë³€ ëª…ë‹¹ ì°¾ê¸° - 1ë“± íŒë§¤ì  ì§€ë„</title>

    <!-- SEO Meta Tags -->
    <meta name="description" content="ë‚´ ì£¼ë³€ì˜ ë¡œë˜ 1ë“± ë‹¹ì²¨ ëª…ë‹¹ì„ ì§€ë„ì—ì„œ ì°¾ì•„ë³´ì„¸ìš”. ì‹¤ì œ ë‹¹ì²¨ íšŸìˆ˜ì™€ ìœ„ì¹˜ ì •ë³´ë¥¼ í•œëˆˆì— í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.">
    <meta name="keywords" content="ë¡œë˜ëª…ë‹¹, ë¡œë˜íŒë§¤ì , ë¡œë˜ì§€ë„, ë¡œë˜1ë“±ì§€ì—­, ë³µê¶Œë°©, ë¡œë˜íŒë§¤ì ìœ„ì¹˜">
    <meta name="author" content="PublicLensk">
    <link rel="canonical" href="https://publiclensk.org/map.html">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="ì£¼ë³€ ëª…ë‹¹ ì°¾ê¸° - 1ë“± íŒë§¤ì  ì§€ë„">
    <meta property="og:description" content="ì „êµ­ ë¡œë˜ 1ë“± ëª…ë‹¹ ìœ„ì¹˜ì™€ ë‹¹ì²¨ íšŸìˆ˜ë¥¼ ì§€ë„ì—ì„œ í™•ì¸í•˜ì„¸ìš”.">
    <meta property="og:image" content="https://publiclensk.org/lotto_logo.png">
    <meta property="og:url" content="https://publiclensk.org/map.html">
    <meta property="og:site_name" content="PublicLensk">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ì£¼ë³€ ëª…ë‹¹ ì°¾ê¸° - 1ë“± íŒë§¤ì  ì§€ë„">
    <meta name="twitter:description" content="ì „êµ­ ë¡œë˜ 1ë“± ëª…ë‹¹ ìœ„ì¹˜ì™€ ë‹¹ì²¨ íšŸìˆ˜ë¥¼ ì§€ë„ì—ì„œ í™•ì¸í•˜ì„¸ìš”.">
    <meta name="twitter:image" content="https://publiclensk.org/lotto_logo.png">
    <link rel="stylesheet" as="style" crossorigin
        href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css" />
    <!-- Kakao Map API -->
    <script type="text/javascript"
        src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=8c78a44cbc45fec0aa35705516f1a082&libraries=services,clusterer"></script>

    <!-- Utility Scripts -->
    <script src="js/utils.js?v=20260122_fix3"></script>
    <script src="js/lotto-enhanced.js?v=20260122_fix3"></script>
    <style>
        :root {
            --primary-blue: #3B82F6;
            --primary-orange: #F97316;
            --text-dark: #1F2937;
            --text-gray: #64748B;
            --bg-white: #FFFFFF;
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            /* Prevent scroll on map page */
            font-family: 'Pretendard', sans-serif;
        }

        .map-container {
            width: 100%;
            height: 100vh;
            position: relative;
        }

        #map {
            width: 100%;
            height: 100%;
        }

        /* === Unified Map Header & Search === */
        .map-ui-top {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 100;
            display: flex;
            flex-direction: column;
            gap: 12px;
            align-items: flex-start;
        }

        .map-brand {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(4px);
            padding: 8px 16px;
            border-radius: 20px;
            box-shadow: var(--shadow-md);
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            transition: transform 0.2s;
        }

        .map-brand:hover {
            transform: scale(1.02);
        }

        .map-brand img {
            height: 24px;
        }

        .map-brand h1 {
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-dark);
            margin: 0;
        }

        .search-box {
            position: relative;
            /* Changed from absolute to flow in .map-ui-top */
            background: white;
            padding: 0;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            width: 340px;
            display: flex;
            overflow: hidden;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .search-input {
            flex: 1;
            padding: 14px 16px;
            border: none;
            font-size: 1rem;
            outline: none;
            color: var(--text-dark);
        }

        .search-btn {
            background: var(--primary-blue);
            color: white;
            border: none;
            padding: 0 20px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }

        .search-btn:hover {
            background: #2563EB;
        }

        /* === Floating Controls (Right Side) === */
        .map-controls {
            position: absolute;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 100;
        }

        .control-group {
            background: white;
            border-radius: 8px;
            box-shadow: var(--shadow-md);
            overflow: hidden;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .control-btn {
            width: 44px;
            height: 44px;
            background: white;
            border: none;
            border-bottom: 1px solid #F1F5F9;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            color: #475569;
            cursor: pointer;
            transition: all 0.2s;
        }

        .control-btn:last-child {
            border-bottom: none;
        }

        .control-btn:hover {
            background: #F8FAFC;
            color: var(--primary-blue);
        }

        .control-btn.active {
            background: #EFF6FF;
            color: var(--primary-blue);
            border-left: 3px solid var(--primary-blue);
        }

        /* === Legend Button === */
        .legend-btn {
            background: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            color: #64748B;
            border: 1px solid #E2E8F0;
            box-shadow: var(--shadow-md);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            margin-left: auto;
            /* Push to right if needed */
        }

        .legend-content {
            position: absolute;
            top: 100%;
            left: 0;
            margin-top: 10px;
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            display: none;
            width: 200px;
        }

        .legend-content.show {
            display: block;
        }

        /* === Bottom Sheet === */
        .bottom-sheet {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            border-top-left-radius: 24px;
            border-top-right-radius: 24px;
            box-shadow: 0 -8px 30px rgba(0, 0, 0, 0.12);
            z-index: 200;
            transform: translateY(110%);
            /* Hidden by default */
            transition: transform 0.35s cubic-bezier(0.16, 1, 0.3, 1);
            max-height: 80vh;
            overflow-y: auto;
        }

        .bottom-sheet.active {
            transform: translateY(0);
        }

        .sheet-handle-area {
            width: 100%;
            padding: 12px 0;
            display: flex;
            justify-content: center;
            cursor: grab;
        }

        .sheet-handle {
            width: 40px;
            height: 5px;
            background: #E2E8F0;
            border-radius: 10px;
        }

        .sheet-body {
            padding: 0 25px 40px 25px;
        }

        .store-header {
            margin-bottom: 20px;
        }

        .store-title {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--text-dark);
            margin-bottom: 6px;
        }

        .store-meta {
            font-size: 0.95rem;
            color: var(--text-gray);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .win-badges {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }

        .badge {
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 700;
            color: white;
        }

        .badge.first {
            background: linear-gradient(135deg, #FFD700, #F59E0B);
        }

        .badge.second {
            background: linear-gradient(135deg, #94A3B8, #64748B);
        }

        /* Action Buttons */
        .sheet-actions {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 12px;
            margin-top: 25px;
        }

        .action-card {
            background: #F8FAFC;
            border-radius: 16px;
            padding: 15px 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            color: var(--text-dark);
            transition: all 0.2s;
            border: 1px solid transparent;
            cursor: pointer;
        }

        .action-card:hover {
            background: white;
            border-color: #E2E8F0;
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .action-icon {
            font-size: 1.5rem;
            margin-bottom: 2px;
        }

        .action-label {
            font-size: 0.85rem;
            font-weight: 600;
        }

        /* Branding Colors for Actions */
        .action-card.kakao .action-icon {
            color: #3C1E1E;
        }

        .action-card.naver .action-icon {
            color: #03C75A;
        }

        .action-card.share .action-icon {
            color: var(--primary-blue);
        }

        /* Search Results */
        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            margin-top: 10px;
            background: white;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            max-height: 300px;
            overflow-y: auto;
            display: none;
            z-index: 101;
        }

        .search-results.show {
            display: block;
        }

        .result-item {
            padding: 12px 16px;
            border-bottom: 1px solid #F1F5F9;
            cursor: pointer;
        }

        .result-item:hover {
            background: #F8FAFC;
        }

        .result-item-name {
            font-weight: 600;
            color: var(--text-dark);
        }

        .result-item-addr {
            font-size: 0.85rem;
            color: var(--text-gray);
            margin-top: 2px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .search-box {
                width: 100%;
                box-sizing: border-box;
            }

            .map-ui-top {
                width: calc(100% - 40px);
            }

            .map-controls {
                right: 10px;
            }

            .bottom-sheet {
                border-radius: 20px 20px 0 0;
            }
        }

        /* Utilities */
        .hidden {
            display: none !important;
        }

        /* Re-Search Button (App-like) */
        .re-search-btn {
            position: absolute;
            top: 100px;
            /* Below header */
            left: 50%;
            transform: translateX(-50%);
            background: white;
            color: var(--primary-blue);
            padding: 10px 20px;
            border-radius: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
            border: 1px solid var(--primary-blue);
            font-size: 0.9rem;
            font-weight: 600;
            z-index: 90;
            cursor: pointer;
            display: none;
            /* Hidden by default */
            align-items: center;
            gap: 6px;
            animation: fadeInDown 0.3s;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translate(-50%, -10px);
            }

            to {
                opacity: 1;
                transform: translate(-50%, 0);
            }
        }

        /* List View Sidebar (Desktop) */
        .store-list-sidebar {
            position: absolute;
            top: 0;
            left: 0;
            width: 380px;
            height: 100%;
            background: white;
            z-index: 150;
            box-shadow: 4px 0 15px rgba(0, 0, 0, 0.1);
            transform: translateX(-100%);
            /* Hidden by default */
            transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            display: flex;
            flex-direction: column;
        }

        .store-list-sidebar.open {
            transform: translateX(0);
        }

        .list-header {
            padding: 20px;
            border-bottom: 1px solid #F1F5F9;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .list-content {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
        }

        .list-card {
            padding: 15px;
            border-bottom: 1px solid #F1F5F9;
            cursor: pointer;
            transition: background 0.2s;
            border-radius: 8px;
        }

        .list-card:hover {
            background: #F8FAFC;
        }

        /* Toggle List Button */
        .list-toggle-btn {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 90;
            background: #1F2937;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            border: none;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            display: flex;
            /* Flex to show */
            align-items: center;
            gap: 8px;
        }

        /* Mobile Adjustments */
        @media (max-width: 768px) {
            .store-list-sidebar {
                width: 100%;
                top: 50%;
                height: 50%;
                border-radius: 20px 20px 0 0;
                transform: translateY(100%);
            }

            .store-list-sidebar.open {
                transform: translateY(0);
            }
        }

        /* Roadview Container */
        #roadview {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 50;
            display: none;
        }
    </style>
    <!-- Userback Feedback Widget -->
    <script>
        window.Userback = window.Userback || {};
        Userback.access_token = "A-SLIenvqC8YcVdhsbiymTsmStV";
        (function (d) {
            var s = d.createElement('script'); s.async = true; s.src = 'https://static.userback.io/widget/v1.js'; (d.head || d.body).appendChild(s);
        })(document);
    </script>
</head>

<body>
    <div class="map-container">
        <!-- Unified Top UI -->
        <div class="map-ui-top">
            <a href="index.html" class="map-brand">
                <img src="lotto_logo.png" alt="ë¡œë˜ ë¡œê³ ">
                <h1>ëª…ë‹¹ ì§€ë„</h1>
            </a>

            <div class="search-box">
                <input type="text" id="search-input" class="search-input" placeholder="ì§€ì—­ëª… ì…ë ¥ (ì˜ˆ: ê°•ë‚¨êµ¬, ì‚¼ì„±ë™)"
                    onkeypress="if(event.keyCode==13) searchLocation();">
                <button class="search-btn" onclick="searchLocation()">ê²€ìƒ‰</button>
            </div>
            <ul id="search-results" class="search-results-list"></ul>
        </div>

        <!-- Floating Controls (Right) -->
        <div class="map-controls">
            <div class="control-group">
                <button id="heatmapBtn" class="control-btn" onclick="toggleHeatmap()" title="íˆíŠ¸ë§µ/ì¼ë°˜ì§€ë„ í† ê¸€">
                    <i class="fas fa-layer-group"></i>
                </button>
                <button id="roadviewBtn" class="control-btn" onclick="toggleRoadviewMode()" title="ë¡œë“œë·°">
                    <i class="fas fa-street-view"></i>
                </button>
            </div>

            <div class="control-group" style="margin-top:10px">
                <button class="control-btn" onclick="zoomIn()" title="í™•ëŒ€">
                    <i class="fas fa-plus"></i>
                </button>
                <button class="control-btn" onclick="zoomOut()" title="ì¶•ì†Œ">
                    <i class="fas fa-minus"></i>
                </button>
            </div>

            <div class="control-group" style="margin-top:10px">
                <button class="control-btn" onclick="goToMyLocation()" title="ë‚´ ìœ„ì¹˜">
                    <i class="fas fa-crosshairs"></i>
                </button>
            </div>

            <div style="margin-top: 10px; position: relative; text-align: right;">
                <button class="legend-btn" onclick="toggleLegend()" title="ë²”ë¡€ ë³´ê¸°">
                    <i class="fas fa-info-circle"></i> ë²”ë¡€
                </button>
                <div id="legend-content" class="legend-content">
                    <div class="legend-title">ë‹¹ì²¨ íšŸìˆ˜ ë²”ë¡€</div>
                    <div class="legend-item" onclick="filterMarkers('gold')">
                        <div class="legend-marker marker-gold"></div> 1ë“± 3íšŒ ì´ìƒ
                    </div>
                    <div class="legend-item" onclick="filterMarkers('silver')">
                        <div class="legend-marker marker-silver"></div> 1ë“± 1-2íšŒ
                    </div>
                    <div class="legend-item" onclick="filterMarkers('normal')">
                        <div class="legend-marker marker-normal"></div> ì¼ë°˜ íŒë§¤ì 
                    </div>
                </div>
            </div>
        </div>

        <!-- Map Area -->
        <div id="map"></div>

        <!-- Bottom Sheet -->
        <div class="bottom-sheet" id="storeBottomSheet">
            <div class="sheet-handle-area" onclick="closeBottomSheet()">
                <div class="sheet-handle"></div>
            </div>
            <div class="sheet-body" id="sheetBody">
                <!-- Content injected via JS -->
            </div>
        </div>

        <!-- Roadview (Hidden by default) -->
        <div id="roadview">
            <div class="roadview-controls">
                <button class="rv-btn" onclick="closeRoadview()">ğŸ—ºï¸ ì§€ë„ ë³´ê¸°</button>
                <button class="rv-btn" onclick="resetRoadview()">â†º ì´ˆê¸°í™”</button>
                <a id="rvLink" href="#" target="_blank" class="rv-btn">ğŸŒ ì¹´ì¹´ì˜¤ë§µ</a>
            </div>
            <button class="roadview-close-btn" onclick="closeRoadview()">âœ• ë‹«ê¸°</button>
        </div>

        <!-- Re-Search Button -->
        <button id="reSearchBtn" class="re-search-btn" onclick="searchInCurrentBounds()">
            <i class="fas fa-redo"></i> í˜„ ì§€ë„ì—ì„œ ê²€ìƒ‰
        </button>

        <!-- List View Toggle -->
        <button class="list-toggle-btn" onclick="toggleListView()">
            <i class="fas fa-list"></i> ëª©ë¡ ë³´ê¸°
        </button>

        <!-- List Sidebar -->
        <div class="store-list-sidebar" id="storeListSidebar">
            <div class="list-header">
                <h2 style="margin:0; font-size:1.2rem; font-weight:700;">ì£¼ë³€ íŒë§¤ì </h2>
                <button onclick="toggleListView()"
                    style="background:none; border:none; font-size:1.2rem; cursor:pointer;">âœ•</button>
            </div>
            <div class="list-content" id="sidebarContent">
                <div style="text-align:center; color:#999; margin-top:50px;">ì§€ë„ë¥¼ ì›€ì§ì—¬ ê²€ìƒ‰í•´ë³´ì„¸ìš”</div>
            </div>
        </div>

        <div id="clickResult" style="display:none;"></div>
    </div>

    <script>
        // Google Sheets API URL (Apps Script Web App)
        const SHEETS_API_URL = 'https://script.google.com/macros/s/AKfycbztxG09bbt0mNRfErtMiNwtdL8jhXk-L_HPL9Enja-iAbse7YgAkHJKUnEGmO5vmUOQ/exec';

        // ì „ì—­ ë³€ìˆ˜
        let storeData = [];
        let map;
        let markers = [];
        let clusterer; // ë§ˆì»¤ í´ëŸ¬ìŠ¤í„°ëŸ¬

        // ë¡œë“œë·° ê´€ë ¨ ë³€ìˆ˜
        let isRoadviewMode = false;
        let roadviewMarker = null;
        let roadviewClient = null;
        let roadview = null;
        let rvResetValue = {}; // ë¡œë“œë·° ë¦¬ì…‹ì„ ìœ„í•œ ì´ˆê¸°ê°’ ì €ì¥

        // Heatmap Variables
        let isHeatmapMode = false;
        let heatmapOverlays = []; // Array to store circle overlays

        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371; // ì§€êµ¬ ë°˜ì§€ë¦„ (km)
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a =
                Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                Math.sin(dLon / 2) * Math.sin(dLon / 2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
            const d = R * c; // ê±°ë¦¬ (km)

            if (d < 1) return Math.round(d * 1000) + 'm';
            return d.toFixed(1) + 'km';
        }

        // === Google Sheetsì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ===
        async function loadStoreData() {
            try {
                console.log('ë¡œë˜ ëª…ë‹¹ ë°ì´í„° ë¡œë”© ì¤‘...');
                const response = await fetch(SHEETS_API_URL);

                if (!response.ok) {
                    throw new Error('API ì‘ë‹µ ì‹¤íŒ¨');
                }

                storeData = await response.json();
                console.log('âœ… ë°ì´í„° ë¡œë“œ ì™„ë£Œ:', storeData.length, 'ê°œ íŒë§¤ì ');

                return storeData;
            } catch (error) {
                console.warn('âš ï¸ API ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨, Fallback ë°ì´í„° ì‚¬ìš©:', error);
                storeData = getFallbackData();
                return storeData;
            }
        }

        // === Fallback ë°ì´í„° (API ì‹¤íŒ¨ ì‹œ ì‚¬ìš©) ===
        function getFallbackData() {
            return [
                {
                    name: "ì‚¼ì„±ëŒ€ë°•ë³µê¶Œë°©",
                    address: "ì„œìš¸ ê°•ë‚¨êµ¬ ë´‰ì€ì‚¬ë¡œ74ê¸¸ 13 101í˜¸",
                    lat: 37.5089,
                    lng: 127.0533,
                    first: 3,
                    second: 7
                },
                {
                    name: "ë¡œë˜ë°±í™”ì ",
                    address: "ì„œìš¸ ì„œì´ˆêµ¬ ê°•ë‚¨ëŒ€ë¡œ 27",
                    lat: 37.5000,
                    lng: 127.0152,
                    first: 4,
                    second: 8
                },
                {
                    name: "í™©ê¸ˆì†ë³µê¶Œ",
                    address: "ì„œìš¸ ì†¡íŒŒêµ¬ ì˜¬ë¦¼í”½ë¡œ35ë‹¤ê¸¸ 42",
                    lat: 37.5144,
                    lng: 127.1060,
                    first: 2,
                    second: 4
                },
                {
                    name: "í–‰ìš´ë³µê¶Œë°©",
                    address: "ì„œìš¸ ì˜ë“±í¬êµ¬ ì—¬ì˜ëŒ€ë¡œ 108",
                    lat: 37.5219,
                    lng: 126.9245,
                    first: 1,
                    second: 3
                }
            ];
        }

        // ì§€ë„ ì´ˆê¸°í™” (Kakao API í‚¤ í•„ìš”)
        async function initMap() {
            // ë¨¼ì € ë°ì´í„° ë¡œë“œ
            await loadStoreData();

            // Kakao APIê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ì„ ê²½ìš°ë¥¼ ëŒ€ë¹„í•œ í´ë°±
            if (typeof kakao === 'undefined' || typeof kakao.maps === 'undefined') {
                console.error('Kakao Maps API not loaded');
                alert('ì§€ë„ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                showSimpleMap();
                return;
            }

            try {
                const container = document.getElementById('map');
                const options = {
                    center: new kakao.maps.LatLng(37.5089, 127.0533), // ì„œìš¸ ê°•ë‚¨
                    level: 5
                };

                map = new kakao.maps.Map(container, options);

                // === ì§€ë„ íƒ€ì… ì»¨íŠ¸ë¡¤ ì¶”ê°€ (ì§€ë„/ìŠ¤ì¹´ì´ë·°) ===
                const mapTypeControl = new kakao.maps.MapTypeControl();
                map.addControl(mapTypeControl, kakao.maps.ControlPosition.TOPRIGHT);

                // íŒë§¤ì  ë§ˆì»¤ í‘œì‹œ
                displayStores();

                // ì˜ì—­ ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
                initBoundsListener();

                // === 2. í´ë¦­ ì´ë²¤íŠ¸ ë“±ë¡ ===
                // Click marker removed

                kakao.maps.event.addListener(map, 'click', function (mouseEvent) {
                    // ë¡œë“œë·° ëª¨ë“œì¼ ê²½ìš°ì—ë§Œ ì‘ë™
                    if (isRoadviewMode) {
                        const latlng = mouseEvent.latLng;
                        if (roadviewMarker) {
                            roadviewMarker.setPosition(latlng);
                        }
                        showRoadview(latlng.getLat(), latlng.getLng());
                    }
                });

                // === 3. ì¤Œ ë³€ê²½ ì´ë²¤íŠ¸ ë“±ë¡ ===
                kakao.maps.event.addListener(map, 'zoom_changed', function () {
                    const level = map.getLevel();
                    const message = 'í˜„ì¬ ì§€ë„ ë ˆë²¨ì€ ' + level + ' ì…ë‹ˆë‹¤';

                    const resultDiv = document.getElementById('clickResult');
                    resultDiv.innerHTML = message;
                    resultDiv.style.display = 'block';
                });

            } catch (error) {
                console.error('Map initialization error:', error);
                alert('ì§€ë„ ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                showSimpleMap();
            }
        }

        // Custom Zoom Functions
        function zoomIn() {
            const level = map.getLevel();
            map.setLevel(level - 1, { animate: true });
        }

        function zoomOut() {
            const level = map.getLevel();
            map.setLevel(level + 1, { animate: true });
        }

        // ê°„ë‹¨í•œ HTML ì§€ë„ (API ëŒ€ì²´ìš©)
        function showSimpleMap() {
            document.getElementById('map').innerHTML = `
                <div style="display: flex; flex-wrap: wrap; padding: 20px; gap: 15px; overflow-y: auto;">
                    ${storeData.map(store => `
                        <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); width: calc(50% - 10px); min-width: 280px;" onclick='showStoreInfo(${JSON.stringify(store)})'>
                            <div style="font-size: 1.2rem; font-weight: 700; color: #1E3A8A; margin-bottom: 8px;">${store.name}</div>
                            <div style="font-size: 0.9rem; color: #64748B; margin-bottom: 12px;">${store.address}</div>
                            <div style="display: flex; gap: 10px;">
                                ${store.first > 0 ? `<span style="background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%); color: white; padding: 6px 12px; border-radius: 6px; font-size: 0.85rem; font-weight: 600;">1ë“± ${store.first}íšŒ</span>` : ''}
                                ${store.second > 0 ? `<span style="background: linear-gradient(135deg, #C0C0C0 0%, #A8A8A8 100%); color: white; padding: 6px 12px; border-radius: 6px; font-size: 0.85rem; font-weight: 600;">2ë“± ${store.second}íšŒ</span>` : ''}
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function displayStores() {
            // í´ëŸ¬ìŠ¤í„°ëŸ¬ ì´ˆê¸°í™”
            clusterer = new kakao.maps.MarkerClusterer({
                map: map,
                averageCenter: true,
                minLevel: 6,
                disableClickZoom: true, // í´ë¦­ ì‹œ 1ë ˆë²¨ì”© í™•ëŒ€ë¥¼ ìœ„í•´ true ì„¤ì •
                styles: [{
                    width: '53px',
                    height: '52px',
                    background: 'rgba(255, 215, 0, 0.9)',
                    borderRadius: '25px',
                    color: '#1F2937',
                    textAlign: 'center',
                    fontWeight: 'bold',
                    lineHeight: '52px',
                    fontSize: '14px'
                }]
            });

            // ë§ˆì»¤ í´ëŸ¬ìŠ¤í„°ëŸ¬ í´ë¦­ ì´ë²¤íŠ¸ ë“±ë¡
            kakao.maps.event.addListener(clusterer, 'clusterclick', function (cluster) {
                // í˜„ì¬ ì§€ë„ ë ˆë²¨ì—ì„œ 1ë ˆë²¨ í™•ëŒ€í•œ ë ˆë²¨
                var level = map.getLevel() - 1;
                // ì§€ë„ë¥¼ í´ë¦­ëœ í´ëŸ¬ìŠ¤í„°ì˜ ë§ˆì»¤ì˜ ìœ„ì¹˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í™•ëŒ€í•©ë‹ˆë‹¤
                map.setLevel(level, { anchor: cluster.getCenter() });
            });

            storeData.forEach(store => {
                const markerPosition = new kakao.maps.LatLng(store.lat, store.lng);

                // ë‹¹ì²¨ íšŸìˆ˜ì— ë”°ë¼ ë§ˆì»¤ ìƒ‰ìƒ ê²°ì •
                let balloonColor;
                if (store.first >= 3) {
                    balloonColor = '#FFD700'; // ê¸ˆìƒ‰
                } else if (store.first >= 1) {
                    balloonColor = '#C0C0C0'; // ì€ìƒ‰
                } else {
                    balloonColor = '#A0A0A0'; // íšŒìƒ‰
                }

                // SVG ë§ˆì»¤ ì´ë¯¸ì§€ ìƒì„± (í˜¸ê°±ë…¸ë…¸ ìŠ¤íƒ€ì¼)
                const svgMarker = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="50" height="30" viewBox="0 0 50 30">
                        <rect x="0" y="0" width="50" height="30" rx="15" ry="15" 
                              fill="${balloonColor}" 
                              stroke="#000" 
                              stroke-width="0.5" 
                              opacity="0.95"/>
                        <text x="25" y="20" 
                              font-family="Pretendard, sans-serif" 
                              font-size="13" 
                              font-weight="700" 
                              fill="#fff" 
                              text-anchor="middle">${store.first || 0}íšŒ</text>
                    </svg>
                `;

                const markerImage = new kakao.maps.MarkerImage(
                    'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(svgMarker),
                    new kakao.maps.Size(50, 30),
                    { offset: new kakao.maps.Point(25, 15) }
                );

                // ë§ˆì»¤ ìƒì„±
                const marker = new kakao.maps.Marker({
                    position: markerPosition,
                    image: markerImage,
                    clickable: true
                });

                // ë§ˆì»¤ì— íŒë§¤ì  ì •ë³´ ì €ì¥
                marker.storeInfo = store;

                // í´ë¦­ ì´ë²¤íŠ¸
                kakao.maps.event.addListener(marker, 'click', function () {
                    // ë¡œë“œë·° ëª¨ë“œì¼ ê²½ìš° ë§ˆì»¤ í´ë¦­ ì‹œ í•´ë‹¹ ìœ„ì¹˜ì˜ ë¡œë“œë·° ì‹¤í–‰
                    if (isRoadviewMode) {
                        showRoadview(store.lat, store.lng, store.name);
                        // ë¡œë“œë·° ë§ˆì»¤ë„ í•´ë‹¹ ìœ„ì¹˜ë¡œ ì´ë™
                        if (roadviewMarker) {
                            roadviewMarker.setPosition(new kakao.maps.LatLng(store.lat, store.lng));
                        }
                        return;
                    }
                    showStoreInfoOnMap(marker.storeInfo);
                });

                markers.push(marker);
            });

            // í´ëŸ¬ìŠ¤í„°ëŸ¬ì— ë§ˆì»¤ ì¶”ê°€
            clusterer.addMarkers(markers);

            // === ìƒìœ„ ë‹¹ì²¨ì (1ë“± 3íšŒ ì´ìƒ)ì— ë§ˆì»¤ íŠ¸ë˜ì»¤ ì ìš© ===
            // 1ë“± ë‹¹ì²¨ íšŸìˆ˜ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬ í›„ ìƒìœ„ 3ê°œ ì„ íƒ
            const topStores = [...storeData].sort((a, b) => b.first - a.first).slice(0, 3);

            markers.forEach(marker => {
                // ìƒìœ„ 3ê°œ ì í¬ì— í¬í•¨ë˜ëŠ”ì§€ í™•ì¸
                const isTopStore = topStores.some(top => top.name === marker.storeInfo.name && top.lat === marker.storeInfo.lat);

                if (isTopStore) {
                    const tracker = new MarkerTracker(map, marker);
                    tracker.run();
                }
            });
        }

        function createMarkerImage(color) {
            const imageSrc = `data:image/svg+xml,%3Csvg width='30' height='40' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M15 0C6.7 0 0 6.7 0 15c0 11.25 15 25 15 25s15-13.75 15-25c0-8.3-6.7-15-15-15z' fill='${encodeURIComponent(color)}'/%3E%3Ccircle cx='15' cy='15' r='8' fill='white'/%3E%3C/svg%3E`;
            const imageSize = new kakao.maps.Size(30, 40);
            const imageOption = { offset: new kakao.maps.Point(15, 40) };

            return new kakao.maps.MarkerImage(imageSrc, imageSize, imageOption);
        }



        function closeOverlay() {
            if (currentOverlay) {
                currentOverlay.setMap(null);
                currentOverlay = null;
            }
        }

        function closeBottomSheet() {
            document.getElementById('storeBottomSheet').classList.remove('active');
            // ì„ íƒëœ ë§ˆì»¤ê°€ ìˆë‹¤ë©´ ë‹«ê¸° ë“± ì¶”ê°€ ë¡œì§ ê°€ëŠ¥
            if (currentOverlay) {
                currentOverlay.setMap(null);
                currentOverlay = null; // ì˜¤ë²„ë ˆì´ë„ ê°™ì´ ë‹«ê¸°
            }
        }

        // Toggle Heatmap Mode
        function toggleHeatmap() {
            isHeatmapMode = !isHeatmapMode;
            const btn = document.getElementById('heatmapBtn');

            if (isHeatmapMode) {
                btn.classList.add('active');

                // Hide Clusters & Markers
                clusterer.clear();
                // Note: markers array still holds marker objects but clusterer manages map display
                // If markers were added directly to map, we'd need to setMap(null) for each.
                // Assuming clusterer handles everything.

                // Draw Heatmap Circles
                drawHeatmap();
            } else {
                btn.classList.remove('active');

                // Clear Heatmap
                clearHeatmap();

                // Show Clusters
                clusterer.addMarkers(markers);
            }
        }

        function drawHeatmap() {
            storeData.forEach(store => {
                // Determine Color & Radius based on 1st prize wins
                let color = '#FFD700'; // Default Yellow
                let opacity = 0.4;
                let radius = 300; // Base 300m

                if (store.first >= 10) {
                    color = '#DC2626'; // Red
                    opacity = 0.6;
                    radius = 500;
                } else if (store.first >= 5) {
                    color = '#F97316'; // Orange
                    opacity = 0.5;
                    radius = 400;
                }

                // Create Circle
                const circle = new kakao.maps.Circle({
                    center: new kakao.maps.LatLng(store.lat, store.lng),
                    radius: radius,
                    strokeWeight: 0,
                    fillColor: color,
                    fillOpacity: opacity
                });

                circle.setMap(map);
                heatmapOverlays.push(circle);

                // Add click listener to circle (optional: open info)
                kakao.maps.event.addListener(circle, 'click', function () {
                    showStoreInfoOnMap(store);
                });
            });
        }

        function clearHeatmap() {
            heatmapOverlays.forEach(circle => circle.setMap(null));
            heatmapOverlays = [];
        }

        function showStoreInfoOnMap(store) {
            // Update Bottom Sheet Content
            const sheetBody = document.getElementById('sheetBody');

            // Badges
            let badges = '';
            if (store.first > 0) badges += `<span class="win-badge first">1ë“± ${store.first}íšŒ</span>`;
            if (store.second > 0) badges += `<span class="win-badge second">2ë“± ${store.second}íšŒ</span>`;
            if (!badges) badges = '<span style="color:#999;font-size:0.9rem;">ë‹¹ì²¨ ì´ë ¥ ì§‘ê³„ ì¤‘</span>';

            // Distance
            let distHTML = '';
            if (currentUserLocation) {
                const dist = calculateDistance(currentUserLocation.lat, currentUserLocation.lng, store.lat, store.lng);
                distHTML = `<div style="font-size:0.9rem; color:#2563EB; margin-top:5px;">ğŸ“ ë‚´ ìœ„ì¹˜ì—ì„œ ${dist}</div>`;
            }

            sheetBody.innerHTML = `
                <div class="sheet-header">
                    <div>
                        <div class="sheet-title">${store.name}</div>
                        <div class="sheet-addr">${store.address}</div>
                        ${distHTML}
                    </div>
                </div>
                <div class="store-wins" style="margin-bottom:20px;">
                    ${badges}
                </div>
                
                <div class="action-grid">
                    <a href="https://map.kakao.com/link/to/${store.name},${store.lat},${store.lng}" target="_blank" rel="noopener noreferrer" class="action-btn kakao">
                        <i class="fas fa-map-marked-alt"></i> ì¹´ì¹´ì˜¤ë§µ
                    </a>
                    <a href="https://map.naver.com/index.nhn?slng=${store.lng}&slat=${store.lat}&stext=${store.name}" target="_blank" rel="noopener noreferrer" class="action-btn naver">
                        <i class="fas fa-map-signs"></i> ë„¤ì´ë²„ë§µ
                    </a>
                    <button class="action-btn share" onclick="processShare('${store.name}', '${store.address}', ${store.first})">
                        <i class="fas fa-share-alt"></i> ê³µìœ í•˜ê¸°
                    </button>
                </div>
                
                 <div style="text-align: center; margin-top: 15px;">
                    <a onclick="showRoadview(${store.lat}, ${store.lng}, '${store.name}')" style="color: #64748B; font-size: 0.85rem; text-decoration: underline; cursor: pointer;">
                        ğŸ“· ë¡œë“œë·° ë¯¸ë¦¬ë³´ê¸°
                    </a>
                </div>
            `;

            // Display Bottom Sheet
            document.getElementById('storeBottomSheet').classList.add('active');

            // Pan map to store (with offset for bottom sheet)
            const position = new kakao.maps.LatLng(store.lat, store.lng);

            // Adjust center slightly down so marker isn't covered by sheet
            // Simple approach: pan directly to lat/lng, then maybe zoom in
            map.panTo(position);

            // Optional: Create a temporary highlight marker or overlay if needed
            // For now, relying on the existing marker or circle interaction
        }

        function showStoreInfo(store) {
            showStoreInfoOnMap(store);
        }

        function closeStoreInfo() {
            document.getElementById('store-info').classList.remove('active');
        }

        function searchLocation(keyword) {
            const query = keyword || document.getElementById('search-input').value.trim();
            if (!query) {
                alert('ê²€ìƒ‰í•  ì§€ì—­ëª…ì´ë‚˜ ì¥ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }

            const ps = new kakao.maps.services.Places();
            const listEl = document.getElementById('search-results');

            // í‚¤ì›Œë“œë¡œ ì¥ì†Œë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤
            ps.keywordSearch(query, function (data, status, pagination) {
                if (status === kakao.maps.services.Status.OK) {
                    // ê²€ìƒ‰ ê²°ê³¼ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
                    displaySearchList(data);

                    // ì²« ë²ˆì§¸ ê²°ê³¼ë¡œ ì´ë™
                    const place = data[0];
                    const coords = new kakao.maps.LatLng(place.y, place.x);
                    map.setCenter(coords);
                    map.setLevel(3);

                } else if (status === kakao.maps.services.Status.ZERO_RESULT) {
                    // í‚¤ì›Œë“œ ì‹¤íŒ¨ ì‹œ ì£¼ì†Œ ê²€ìƒ‰
                    const geocoder = new kakao.maps.services.Geocoder();
                    geocoder.addressSearch(query, function (result, addrStatus) {
                        if (addrStatus === kakao.maps.services.Status.OK) {
                            const coords = new kakao.maps.LatLng(result[0].y, result[0].x);
                            map.setCenter(coords);
                            map.setLevel(3);
                            listEl.style.display = 'none'; // ì£¼ì†Œ ê²€ìƒ‰ ì‹œ ë¦¬ìŠ¤íŠ¸ ìˆ¨ê¹€
                        } else {
                            alert('ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.');
                            listEl.style.display = 'none';
                        }
                    });
                } else {
                    alert('ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
            });
        }

        function displaySearchList(places) {
            const listEl = document.getElementById('search-results');
            listEl.innerHTML = '';
            listEl.style.display = 'block';

            places.slice(0, 5).forEach(place => {
                const item = document.createElement('li');
                item.innerHTML = `
            <div class="search-item-title">${place.place_name}</div>
                <div class="search-item-addr">${place.address_name}</div>
        `;
                item.onclick = () => {
                    const coords = new kakao.maps.LatLng(place.y, place.x);
                    map.setCenter(coords);
                    map.setLevel(3);

                    // ì„ì‹œ ë§ˆì»¤
                    const marker = new kakao.maps.Marker({
                        map: map,
                        position: coords
                    });
                    const infowindow = new kakao.maps.InfoWindow({
                        content: `<div style="padding:5px;font-size:12px;">${place.place_name}</div>`
                    });
                    infowindow.open(map, marker);
                    setTimeout(() => { marker.setMap(null); infowindow.close(); }, 3000);

                    listEl.style.display = 'none';
                };
                listEl.appendChild(item);
            });
        }


        function goToMyLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition((position) => {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;

                    currentUserLocation = { lat, lng }; // ìœ„ì¹˜ ì €ì¥

                    if (typeof kakao !== 'undefined' && map) {
                        const moveLatLon = new kakao.maps.LatLng(lat, lng);
                        map.setCenter(moveLatLon);
                    } else {
                        alert(`ë‚´ ìœ„ì¹˜: ${lat.toFixed(4)}, ${lng.toFixed(4)}\nì§€ë„ API ì—°ë™ í›„ ìœ„ì¹˜ ì´ë™ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.`);
                    }
                }, () => {
                    alert('ìœ„ì¹˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                });
            } else {
                alert('ì´ ë¸Œë¼ìš°ì €ëŠ” ìœ„ì¹˜ ì„œë¹„ìŠ¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
            }
        }

        // ë¡œë“œë·° ì´ˆê¸°í™” ë° í‘œì‹œ í•¨ìˆ˜
        function initRoadview(lat, lng) {
            showRoadview(lat, lng, null);
        }

        // ë¡œë“œë·° í‘œì‹œ í•¨ìˆ˜ (ì´ë¦„ ì¸ì ì¶”ê°€)
        function showRoadview(lat, lng, name) {
            const roadviewContainer = document.getElementById('roadview');

            // ì „ì—­ ë³€ìˆ˜ ì´ˆê¸°í™” (ì—†ìœ¼ë©´ ìƒì„±)
            if (!roadview) {
                roadview = new kakao.maps.Roadview(roadviewContainer);
                roadviewClient = new kakao.maps.RoadviewClient();
            }

            const position = new kakao.maps.LatLng(lat, lng);

            roadviewClient.getNearestPanoId(position, 50, function (panoId) {
                if (panoId) {
                    roadviewContainer.style.display = 'block';

                    roadview.setPanoId(panoId);

                    kakao.maps.event.addListener(roadview, 'init', function () {
                        // ë§ˆì»¤ ì¶”ê°€
                        const rMarker = new kakao.maps.Marker({
                            position: position,
                            map: roadview
                        });

                        // ì»¤ìŠ¤í…€ ì˜¤ë²„ë ˆì´ ì¶”ê°€ (ì´ë¦„ì´ ìˆì„ ê²½ìš°)
                        if (name) {
                            const content = `
            <div class="custom-overlay" style="min-width:auto; padding:10px 15px; box-shadow:0 4px 12px rgba(0,0,0,0.3); border:1px solid #ddd;">
                <div class="overlay-title" style="margin:0; font-size:1rem; color:#1E3A8A;">${name}</div>
            </div>
            `;

                            const rvCustomOverlay = new kakao.maps.CustomOverlay({
                                position: position,
                                content: content,
                                yAnchor: 1.5
                            });
                            rvCustomOverlay.setMap(roadview);
                        }

                        // ë·°í¬ì¸íŠ¸ ì¡°ì •
                        const projection = roadview.getProjection();
                        const viewpoint = projection.viewpointFromCoords(rMarker.getPosition(), rMarker.getAltitude());
                        roadview.setViewpoint(viewpoint);

                        // ì´ˆê¸°í™” ê°’ ì €ì¥ (Reset ê¸°ëŠ¥ìš©)
                        rvResetValue = {
                            panoId: panoId,
                            pan: viewpoint.pan,
                            tilt: viewpoint.tilt,
                            zoom: viewpoint.zoom
                        };

                        // ì™¸ë¶€ ë§í¬ ì—…ë°ì´íŠ¸
                        const rvLink = document.getElementById('rvLink');
                        if (rvLink) {
                            rvLink.href = 'https://map.kakao.com/?panoid=' + panoId + '&pan=' + viewpoint.pan + '&tilt=' + viewpoint.tilt + '&zoom=' + viewpoint.zoom;
                        }
                    });
                } else {
                    alert('í•´ë‹¹ ìœ„ì¹˜ì˜ ë¡œë“œë·°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                }
            });
        }

        // ë¡œë“œë·° ë¦¬ì…‹ í•¨ìˆ˜
        function resetRoadview() {
            if (roadview && rvResetValue.panoId) {
                roadview.setViewpoint({
                    pan: rvResetValue.pan,
                    tilt: rvResetValue.tilt,
                    zoom: rvResetValue.zoom
                });
                roadview.setPanoId(rvResetValue.panoId);
            }
        }

        // ë¡œë“œë·° ë‹«ê¸° í•¨ìˆ˜
        function closeRoadview() {
            document.getElementById('roadview').style.display = 'none';
            document.getElementById('roadview-close').style.display = 'none';
        }

        // Toggle Roadview Mode
        function toggleRoadviewMode() {
            const btn = document.getElementById('roadviewBtn');
            isRoadviewMode = !isRoadviewMode;

            if (isRoadviewMode) {
                btn.classList.add('active');

                // Switch to Roadview overlay
                map.addOverlayMapTypeId(kakao.maps.MapTypeId.ROADVIEW);

                // Create Roadview Walker Marker (Dongdong-i)
                const markImage = new kakao.maps.MarkerImage(
                    'https://t1.daumcdn.net/localimg/localimages/07/2018/pc/roadview_minimap_wk_2018.png',
                    new kakao.maps.Size(26, 46),
                    {
                        spriteSize: new kakao.maps.Size(1666, 168),
                        spriteOrigin: new kakao.maps.Point(705, 114),
                        offset: new kakao.maps.Point(13, 46)
                    }
                );

                if (!roadviewMarker) {
                    roadviewMarker = new kakao.maps.Marker({
                        image: markImage,
                        position: map.getCenter(),
                        draggable: true,
                        map: map
                    });

                    // Event: When drag ends, show roadview
                    kakao.maps.event.addListener(roadviewMarker, 'dragend', function () {
                        const position = roadviewMarker.getPosition();
                        showRoadview(position.getLat(), position.getLng());
                    });
                } else {
                    roadviewMarker.setPosition(map.getCenter());
                    roadviewMarker.setMap(map);
                }

                alert('ì§€ë„ ìœ„ì˜ íŒŒë€ ì„ (ë„ë¡œ)ë¥¼ í´ë¦­í•˜ë©´ ë¡œë“œë·°ê°€ ì—´ë¦½ë‹ˆë‹¤.');

            } else {
                btn.classList.remove('active');

                // Remove Roadview overlay
                map.removeOverlayMapTypeId(kakao.maps.MapTypeId.ROADVIEW);

                // Remove Marker
                if (roadviewMarker) {
                    roadviewMarker.setMap(null);
                }

                // Hide Roadview container if open
                closeRoadview();
            }
        }



        /**
         * ì§€ë„ ì˜ì—­ ì™¸ë¶€ì— ì¡´ì¬í•˜ëŠ” ë§ˆì»¤ë¥¼ ì¶”ì í•˜ëŠ” ê¸°ëŠ¥ì„ ê°€ì§„ ê°ì²´ì…ë‹ˆë‹¤.
         * í´ë¦¬í•‘ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ trackerì˜ ì¢Œí‘œë¥¼ êµ¬í•˜ê³  ìˆìŠµë‹ˆë‹¤.
         */
        function MarkerTracker(map, target) {
            // í´ë¦¬í•‘ì„ ìœ„í•œ outcode
            var OUTCODE = {
                INSIDE: 0, // 0b0000
                TOP: 8, //0b1000
                RIGHT: 2, // 0b0010
                BOTTOM: 4, // 0b0100
                LEFT: 1 // 0b0001
            };

            // viewport ì˜ì—­ì„ êµ¬í•˜ê¸° ìœ„í•œ bufferê°’
            var BOUNDS_BUFFER = 30;

            // í´ë¦¬í•‘ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ trackerì˜ ì¢Œí‘œë¥¼ êµ¬í•˜ê¸° ìœ„í•œ bufferê°’
            var CLIP_BUFFER = 40;

            // trakcer ì—˜ë¦¬ë¨¼íŠ¸
            var tracker = document.createElement('div');
            tracker.className = 'tracker';

            // ë‚´ë¶€ ì•„ì´ì½˜
            var icon = document.createElement('div');
            icon.className = 'icon';

            // ì™¸ë¶€ì— ìˆëŠ” targetì˜ ìœ„ì¹˜ì— ë”°ë¼ íšŒì „í•˜ëŠ” ë§í’ì„  ëª¨ì–‘ì˜ ì—˜ë¦¬ë¨¼íŠ¸
            var balloon = document.createElement('div');
            balloon.className = 'balloon';

            tracker.appendChild(balloon);
            tracker.appendChild(icon);

            map.getNode().appendChild(tracker);

            // trakerë¥¼ í´ë¦­í•˜ë©´ targetì˜ ìœ„ì¹˜ë¥¼ ì§€ë„ ì¤‘ì‹¬ìœ¼ë¡œ ì§€ì •í•˜ê³  ì˜¤ë²„ë ˆì´ í‘œì‹œ
            tracker.onclick = function () {
                map.setCenter(target.getPosition());
                setVisible(false);
                // í•´ë‹¹ ë§ˆì»¤ì˜ ì˜¤ë²„ë ˆì´ ì—´ê¸°
                if (target.storeInfo) {
                    showStoreInfoOnMap(target.storeInfo);
                }
            };

            // targetì˜ ìœ„ì¹˜ë¥¼ ì¶”ì í•˜ëŠ” í•¨ìˆ˜
            function tracking() {
                var proj = map.getProjection();

                // ì§€ë„ì˜ ì˜ì—­ì„ êµ¬í•©ë‹ˆë‹¤.
                var bounds = map.getBounds();

                // ì§€ë„ì˜ ì˜ì—­ì„ ê¸°ì¤€ìœ¼ë¡œ í™•ì¥ëœ ì˜ì—­ì„ êµ¬í•©ë‹ˆë‹¤.
                var extBounds = extendBounds(bounds, proj);

                // targetì´ í™•ì¥ëœ ì˜ì—­ì— ì†í•˜ëŠ”ì§€ íŒë‹¨í•˜ê³ 
                if (extBounds.contain(target.getPosition())) {
                    // ì†í•˜ë©´ trackerë¥¼ ìˆ¨ê¹ë‹ˆë‹¤.
                    setVisible(false);
                } else {
                    // targetì´ ì˜ì—­ ë°–ì— ìˆìœ¼ë©´ ê³„ì‚°ì„ ì‹œì‘í•©ë‹ˆë‹¤.

                    // TooltipMarkerì˜ ìœ„ì¹˜
                    var pos = proj.containerPointFromCoords(target.getPosition());

                    // ì§€ë„ ì¤‘ì‹¬ì˜ ìœ„ì¹˜
                    var center = proj.containerPointFromCoords(map.getCenter());

                    // í˜„ì¬ ë³´ì´ëŠ” ì§€ë„ì˜ ì˜ì—­ì˜ ë‚¨ì„œìª½ í™”ë©´ ì¢Œí‘œ
                    var sw = proj.containerPointFromCoords(bounds.getSouthWest());

                    // í˜„ì¬ ë³´ì´ëŠ” ì§€ë„ì˜ ì˜ì—­ì˜ ë¶ë™ìª½ í™”ë©´ ì¢Œí‘œ
                    var ne = proj.containerPointFromCoords(bounds.getNorthEast());

                    // í´ë¦¬í•‘í•  ê°€ìƒì˜ ë‚´ë¶€ ì˜ì—­ì„ ë§Œë“­ë‹ˆë‹¤.
                    var top = ne.y + CLIP_BUFFER;
                    var right = ne.x - CLIP_BUFFER;
                    var bottom = sw.y - CLIP_BUFFER;
                    var left = sw.x + CLIP_BUFFER;

                    // ê³„ì‚°ëœ ëª¨ë“  ì¢Œí‘œë¥¼ í´ë¦¬í•‘ ë¡œì§ì— ë„£ì–´ ì¢Œí‘œë¥¼ ì–»ìŠµë‹ˆë‹¤.
                    var clipPosition = getClipPosition(top, right, bottom, left, center, pos);

                    // í´ë¦¬í•‘ëœ ì¢Œí‘œë¥¼ trackerì˜ ìœ„ì¹˜ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.
                    tracker.style.top = clipPosition.y + 'px';
                    tracker.style.left = clipPosition.x + 'px';

                    // ë§í’ì„ ì˜ íšŒì „ê°ì„ ì–»ìŠµë‹ˆë‹¤.
                    var angle = getAngle(center, pos);

                    // íšŒì „ê°ì„ CSS transformì„ ì‚¬ìš©í•˜ì—¬ ì§€ì •í•©ë‹ˆë‹¤.
                    balloon.style.cssText +=
                        '-ms-transform: rotate(' + angle + 'deg);' +
                        '-webkit-transform: rotate(' + angle + 'deg);' +
                        'transform: rotate(' + angle + 'deg);';

                    // targetì´ ì˜ì—­ ë°–ì— ìˆì„ ê²½ìš° trackerë¥¼ ë…¸ì¶œí•©ë‹ˆë‹¤.
                    setVisible(true);
                }
            }

            // ìƒí•˜ì¢Œìš°ë¡œ BOUNDS_BUFFER(30px)ë§Œí¼ boundsë¥¼ í™•ì¥ í•˜ëŠ” í•¨ìˆ˜
            function extendBounds(bounds, proj) {
                var sw = proj.pointFromCoords(bounds.getSouthWest());
                var ne = proj.pointFromCoords(bounds.getNorthEast());

                sw.x -= BOUNDS_BUFFER;
                sw.y += BOUNDS_BUFFER;

                ne.x += BOUNDS_BUFFER;
                ne.y -= BOUNDS_BUFFER;

                return new kakao.maps.LatLngBounds(
                    proj.coordsFromPoint(sw), proj.coordsFromPoint(ne));
            }

            // Cohenâ€“Sutherland clipping algorithm
            function getClipPosition(top, right, bottom, left, inner, outer) {
                function calcOutcode(x, y) {
                    var outcode = OUTCODE.INSIDE;

                    if (x < left) {
                        outcode |= OUTCODE.LEFT;
                    } else if (x > right) {
                        outcode |= OUTCODE.RIGHT;
                    }

                    if (y < top) {
                        outcode |= OUTCODE.TOP;
                    } else if (y > bottom) {
                        outcode |= OUTCODE.BOTTOM;
                    }

                    return outcode;
                }

                var ix = inner.x;
                var iy = inner.y;
                var ox = outer.x;
                var oy = outer.y;

                var code = calcOutcode(ox, oy);

                while (true) {
                    if (!code) {
                        break;
                    }

                    if (code & OUTCODE.TOP) {
                        ox = ox + (ix - ox) / (iy - oy) * (top - oy);
                        oy = top;
                    } else if (code & OUTCODE.RIGHT) {
                        oy = oy + (iy - oy) / (ix - ox) * (right - ox);
                        ox = right;
                    } else if (code & OUTCODE.BOTTOM) {
                        ox = ox + (ix - ox) / (iy - oy) * (bottom - oy);
                        oy = bottom;
                    } else if (code & OUTCODE.LEFT) {
                        oy = oy + (iy - oy) / (ix - ox) * (left - ox);
                        ox = left;
                    }

                    code = calcOutcode(ox, oy);
                }

                return { x: ox, y: oy };
            }

            // ë§í’ì„ ì˜ íšŒì „ê°ì„ êµ¬í•˜ê¸° ìœ„í•œ í•¨ìˆ˜
            function getAngle(center, target) {
                var dx = target.x - center.x;
                var dy = center.y - target.y;
                var deg = Math.atan2(dy, dx) * 180 / Math.PI;

                return ((-deg + 360) % 360 | 0) + 90;
            }

            // trackerì˜ ë³´ì„/ìˆ¨ê¹€ì„ ì§€ì •í•˜ëŠ” í•¨ìˆ˜
            function setVisible(visible) {
                tracker.style.display = visible ? 'block' : 'none';
            }

            // Map ê°ì²´ì˜ 'zoom_start' ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
            function hideTracker() {
                setVisible(false);
            }

            // targetì˜ ì¶”ì ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.
            this.run = function () {
                kakao.maps.event.addListener(map, 'zoom_start', hideTracker);
                kakao.maps.event.addListener(map, 'zoom_changed', tracking);
                kakao.maps.event.addListener(map, 'center_changed', tracking);
                tracking();
            };

            // targetì˜ ì¶”ì ì„ ì¤‘ì§€í•©ë‹ˆë‹¤.
            this.stop = function () {
                kakao.maps.event.removeListener(map, 'zoom_start', hideTracker);
                kakao.maps.event.removeListener(map, 'zoom_changed', tracking);
                kakao.maps.event.removeListener(map, 'center_changed', tracking);
                setVisible(false);
            };
        }

        // --- Marker Filtering Logic ---
        function filterMarkers(type) {
            if (!clusterer || !markers.length) return;

            // Highlight selected legend item
            ['gold', 'silver', 'normal'].forEach(t => {
                const el = document.getElementById('legend-' + t);
                if (el) el.style.opacity = (type === 'all' || type === t) ? '1' : '0.4';
            });
            const titleEl = document.querySelector('.legend-title');
            if (titleEl) titleEl.style.fontWeight = type === 'all' ? 'bold' : 'normal';

            // Filter markers
            const filteredMarkers = markers.filter(marker => {
                const count = marker.storeInfo.first;
                if (type === 'all') return true;
                if (type === 'gold') return count >= 3;
                if (type === 'silver') return count >= 1 && count < 3;
                if (type === 'normal') return count === 0;
                return true;
            });

            // Update Clusterer
            clusterer.clear();
            clusterer.addMarkers(filteredMarkers);
        }

        // --- Map Utilities (Resize & Bounds) ---

        // 1. Window Resize Handler
        window.addEventListener('resize', function () {
            if (map) {
                map.relayout();
            }
        });

        // === 2. Bounds Changed Handler (Updated for "Search Here") ===
        function initBoundsListener() {
            if (map) {
                kakao.maps.event.addListener(map, 'dragend', function () {
                    // Show "Search Here" button when map is moved
                    document.getElementById('reSearchBtn').style.display = 'flex';
                });

                kakao.maps.event.addListener(map, 'zoom_changed', function () {
                    document.getElementById('reSearchBtn').style.display = 'flex';
                });
            }
        }

        // === List View & Search Logic ===

        let isListOpen = false;

        function toggleListView() {
            const sidebar = document.getElementById('storeListSidebar');
            isListOpen = !isListOpen;

            if (isListOpen) {
                sidebar.classList.add('open');
                // Auto-refresh list if opening
                searchInCurrentBounds();
            } else {
                sidebar.classList.remove('open');
            }
        }

        function searchInCurrentBounds() {
            // Hide button
            document.getElementById('reSearchBtn').style.display = 'none';

            // Get Current Bounds
            const bounds = map.getBounds();
            const sw = bounds.getSouthWest();
            const ne = bounds.getNorthEast();

            // Filter stores within bounds
            const visibleStores = storeData.filter(store => {
                return store.lat >= sw.getLat() && store.lat <= ne.getLat() &&
                    store.lng >= sw.getLng() && store.lng <= ne.getLng();
            });

            // Sort by 1st prize wins (desc)
            visibleStores.sort((a, b) => b.first - a.first);

            renderSidebar(visibleStores);

            if (isListOpen) {
                showToast(`${visibleStores.length}ê°œì˜ íŒë§¤ì ì´ ê²€ìƒ‰ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            }
        }

        function renderSidebar(stores) {
            const container = document.getElementById('sidebarContent');
            if (stores.length === 0) {
                container.innerHTML = '<div style="text-align:center; padding:20px; color:#666;">ì´ ì§€ì—­ì—ëŠ” íŒë§¤ì ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }

            container.innerHTML = stores.map(store => `
                <div class="list-card" onclick="moveToStore(${store.lat}, ${store.lng})">
                    <div style="display:flex; justify-content:space-between; align-items:flex-start;">
                        <div style="font-weight:700; color:#1F2937; font-size:1rem;">${store.name}</div>
                        ${store.first > 0 ? `<span class="badge first" style="font-size:0.75rem;">1ë“± ${store.first}íšŒ</span>` : ''}
                    </div>
                    <div style="font-size:0.85rem; color:#64748B; margin-top:4px;">${store.address}</div>
                </div>
            `).join('');
        }

        function moveToStore(lat, lng) {
            map.panTo(new kakao.maps.LatLng(lat, lng));
            // Specifically find the store object to show info
            const target = storeData.find(s => s.lat === lat && s.lng === lng);
            if (target) showStoreInfoOnMap(target);

            // On mobile, maybe close list?
            if (window.innerWidth <= 768) {
                toggleListView();
            }
        }

        // === UI Control Functions ===
        function toggleLegend() {
            const content = document.getElementById('legend-content');
            const btn = document.querySelector('.legend-btn');

            if (content.style.display === 'block') {
                content.style.display = 'none';
                btn.style.background = 'white';
                btn.style.color = '#64748B';
            } else {
                content.style.display = 'block';
                btn.style.background = '#EFF6FF';
                btn.style.color = '#3B82F6';
            }
        }

        function toggleBottomSheet() {
            const sheet = document.getElementById('storeBottomSheet');
            if (sheet.classList.contains('active')) {
                closeBottomSheet();
            }
        }

        // === Share Functionality ===
        async function processShare(name, address, count) {
            const shareData = {
                title: `${name} - ë¡œë˜ ëª…ë‹¹`,
                text: `${name}ì€ 1ë“± ë‹¹ì²¨ì´ ${count}íšŒë‚˜ ë‚˜ì˜¨ ëª…ë‹¹ì…ë‹ˆë‹¤! \nì£¼ì†Œ: ${address}\n`,
                url: window.location.href
            };

            if (navigator.share) {
                try {
                    await navigator.share(shareData);
                } catch (err) {
                    // Share cancelled or failed
                }
            } else {
                // Clipboard Fallback
                const textToCopy = `${shareData.title}\n${shareData.text}`;
                copyToClipboard(textToCopy);
            }
        }

        function copyToClipboard(text) {
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(text).then(() => showToast('ì •ë³´ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!'));
            } else {
                fallbackCopy(text);
            }
        }

        function fallbackCopy(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.position = "fixed";
            textArea.style.left = "-9999px";
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            try {
                document.execCommand('copy');
                showToast('ì •ë³´ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            } catch (err) {
                console.error('Copy failed', err);
            }
            document.body.removeChild(textArea);
        }

        function showToast(message) {
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%);
                background: rgba(0,0,0,0.8); color: white; padding: 12px 24px;
                border-radius: 25px; font-size: 0.9rem; z-index: 1000;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15); animation: fadeIn 0.3s;
            `;
            toast.textContent = message;
            document.body.appendChild(toast);
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transition = 'opacity 0.3s';
                setTimeout(() => document.body.removeChild(toast), 300);
            }, 2000);
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì§€ë„ ì´ˆê¸°í™”
        window.onload = function () {
            initMap();
        };
    </script>

    <!-- Guide Section -->
    <div style="background: white; padding: 60px 20px; margin-top: 20px;">
        <div style="max-width: 1000px; margin: 0 auto;">
            <h2
                style="text-align: center; font-size: 2.2rem; font-weight: 700; color: var(--primary-blue); margin-bottom: 40px;">
                ğŸ—ºï¸ ëª…ë‹¹ íŒë§¤ì  ì§€ë„ ì‚¬ìš© ê°€ì´ë“œ
            </h2>

            <div
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; margin-bottom: 50px;">
                <div style="padding: 30px; background: #f8f9fa; border-radius: 16px; border-left: 4px solid  #FFD700;">
                    <h3 style="color: var(--primary-blue); font-size: 1.4rem; margin-bottom: 15px; font-weight: 700;">ğŸ“
                        ë§ˆì»¤ í™•ì¸í•˜ê¸°</h3>
                    <p style="font-size: 1.05rem; line-height: 1.8; color: var(--text-secondary); margin-bottom: 10px;">
                        ì§€ë„ì— í‘œì‹œëœ í’ì„  ë§ˆì»¤ë¥¼ í´ë¦­í•˜ë©´ íŒë§¤ì  ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    </p>
                    <ul style="font-size: 1rem; line-height: 1.8; color: var(--text-secondary); padding-left: 20px;">
                        <li><strong>ê¸ˆìƒ‰ ë§ˆì»¤(3+)</strong>: 1ë“± 3íšŒ ì´ìƒ ë‹¹ì²¨ íŒë§¤ì </li>
                        <li><strong>ì€ìƒ‰ ë§ˆì»¤(1-2)</strong>: 1ë“± 1-2íšŒ ë‹¹ì²¨ íŒë§¤ì </li>
                        <li><strong>íšŒìƒ‰ ë§ˆì»¤</strong>: ì¼ë°˜ íŒë§¤ì </li>
                    </ul>
                </div>

                <div style="padding: 30px; background: #f8f9fa; border-radius: 16px; border-left: 4px solid #FEE500;">
                    <h3 style="color: var(--primary-orange); font-size: 1.4rem; margin-bottom: 15px; font-weight: 700;">
                        ğŸ“· ë¡œë“œë·° ê¸°ëŠ¥</h3>
                    <p style="font-size: 1.05rem; line-height: 1.8; color: var(--text-secondary); margin-bottom: 10px;">
                        ë§ˆì»¤ë¥¼ í´ë¦­í•˜ë©´ ë‚˜íƒ€ë‚˜ëŠ” ì¸í¬ìœˆë„ìš°ì—ì„œ "ë¡œë“œë·° ë³´ê¸°" ë²„íŠ¼ì„ í´ë¦­í•˜ë©´
                        í•´ë‹¹ íŒë§¤ì ì˜ ê±°ë¦¬ë·°ë¥¼ í˜ì´ì§€ ë‚´ì—ì„œ ë°”ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    </p>
                    <p style="font-size: 1rem; line-height: 1.8; color: var(--text-secondary);">
                        ì‹¤ì œë¡œ íŒë§¤ì ì„ ë°©ë¬¸í•˜ê¸° ì „ì— ì£¼ë³€ í™˜ê²½ê³¼ ìœ„ì¹˜ë¥¼ ë¯¸ë¦¬ íŒŒì•…í•  ìˆ˜ ìˆì–´ ìœ ìš©í•©ë‹ˆë‹¤.
                    </p>
                </div>

                <div style="padding: 30px; background: #f8f9fa; border-radius: 16px; border-left: 4px solid #3B82F6;">
                    <h3 style="color: #667eea; font-size: 1.4rem; margin-bottom: 15px; font-weight: 700;">ğŸ” ê²€ìƒ‰ ê¸°ëŠ¥</h3>
                    <p style="font-size: 1.05rem; line-height: 1.8; color: var(--text-secondary); margin-bottom: 10px;">
                        ì™¼ìª½ ìƒë‹¨ì˜ ê²€ìƒ‰ì°½ì— ì§€ì—­ëª…ì´ë‚˜ ì¥ì†Œëª…ì„ ì…ë ¥í•˜ê³  ê²€ìƒ‰í•˜ë©´ í•´ë‹¹ ìœ„ì¹˜ë¡œ ì§€ë„ê°€ ì´ë™í•©ë‹ˆë‹¤.
                    </p>
                    <ul style="font-size: 1rem; line-height: 1.8; color: var(--text-secondary); padding-left: 20px;">
                        <li>ê²€ìƒ‰ í›„ ì£¼ë³€ 1km ì´ë‚´ì˜ ëª…ë‹¹ ë§ˆì»¤ê°€ ìë™ìœ¼ë¡œ ê°•ì¡°ë©ë‹ˆë‹¤</li>
                        <li>Enter í‚¤ë¡œë„ ê²€ìƒ‰ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤</li>
                        <li>ì˜ˆì‹œ: "ê°•ë‚¨ì—­", "ì‚¼ì„±ë™", "ì—¬ì˜ë„" ë“±</li>
                    </ul>
                </div>
            </div>

            <div
                style="background: linear-gradient(135deg, #e0f2f1 0%, #b2dfdb 100%); padding: 30px; border-radius: 12px; border-left: 5px solid #00897b; margin-bottom: 40px;">
                <h3 style="color: #00695c; font-size: 1.3rem; margin-bottom: 15px; font-weight: 700;">ğŸ’¡ ë˜‘ë˜‘í•œ í™œìš© íŒ</h3>
                <ul
                    style="font-size: 1.05rem; line-height: 2; color: var(--text-secondary); padding-left: 20px; margin: 0;">
                    <li><strong>ë‚´ ìœ„ì¹˜ ë²„íŠ¼</strong>ì„ í´ë¦­í•˜ë©´ í˜„ì¬ ìœ„ì¹˜ ì£¼ë³€ì˜ ëª…ë‹¹ì„ ë¹ ë¥´ê²Œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤</li>
                    <li><strong>ì¤Œ ì¸/ì•„ì›ƒ</strong>ì„ í†µí•´ ë” ë„“ì€ ì§€ì—­ì˜ ëª…ë‹¹ì„ ë¹„êµí•´ë³´ì„¸ìš”</li>
                    <li><strong>í´ëŸ¬ìŠ¤í„°ë§ ê¸°ëŠ¥</strong>ìœ¼ë¡œ ì¤Œ ì•„ì›ƒ ì‹œ ì—¬ëŸ¬ ë§ˆì»¤ê°€ í•˜ë‚˜ë¡œ ê·¸ë£¹í™”ë˜ì–´ ë³´ê¸° í¸ë¦¬í•©ë‹ˆë‹¤</li>
                    <li><strong>ê¸¸ì°¾ê¸° ë²„íŠ¼</strong>ì„ í´ë¦­í•˜ë©´ ì¹´ì¹´ì˜¤ë§µ ì•±ìœ¼ë¡œ ê²½ë¡œ ì•ˆë‚´ë¥¼ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤</li>
                </ul>
            </div>

            <div
                style="background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%); padding: 30px; border-radius: 12px; border-left: 5px solid #f57c00;">
                <h3 style="color: #e65100; font-size: 1.3rem; margin-bottom: 15px; font-weight: 700;">âš ï¸ ìœ ì˜ì‚¬í•­</h3>
                <ul
                    style="font-size: 1.05rem; line-height: 2; color: var(--text-secondary); padding-left: 20px; margin: 0;">
                    <li>íŒë§¤ì ì˜ ê³¼ê±° ë‹¹ì²¨ ì´ë ¥ì€ <strong>ì°¸ê³ ìš©</strong>ì´ë©°, ë¯¸ë˜ ë‹¹ì²¨ì„ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤</li>
                    <li>ëª¨ë“  ë³µê¶Œ íŒë§¤ì ì˜ ë‹¹ì²¨ í™•ë¥ ì€ <strong>ë™ì¼</strong>í•©ë‹ˆë‹¤</li>
                    <li>ëª…ë‹¹ ë°©ë¬¸ì€ ì¬ë¯¸ì™€ í¥ë¯¸ë¥¼ ìœ„í•œ ê²ƒì´ë©°, ê³¼ë„í•œ ê¸°ëŒ€ëŠ” ê¸ˆë¬¼ì…ë‹ˆë‹¤</li>
                    <li>ì±…ì„ ìˆëŠ” ë³µê¶Œ êµ¬ë§¤ë¥¼ ìœ„í•´ ì ì ˆí•œ ì˜ˆì‚° ê´€ë¦¬ë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤</li>
                </ul>
            </div>

            <div style="text-align: center; margin-top: 50px;">
                <h3 style="font-size: 1.8rem; font-weight: 700; color: var(--text-primary); margin-bottom: 30px;">
                    ğŸ’¬ ë” ì•Œì•„ë³´ê¸°
                </h3>
                <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
                    <a href="about.html"
                        style="text-decoration: none; padding: 15px 30px; background: var(--primary-blue); color: white; border-radius: 10px; font-weight: 600; transition: all 0.3s ease;">
                        ì„œë¹„ìŠ¤ ì†Œê°œ
                    </a>
                    <a href="guide.html"
                        style="text-decoration: none; padding: 15px 30px; background: var(--primary-orange); color: white; border-radius: 10px; font-weight: 600; transition: all 0.3s ease;">
                        ë³µê¶Œ ê°€ì´ë“œ
                    </a>
                    <a href="faq.html"
                        style="text-decoration: none; padding: 15px 30px; background: #667eea; color: white; border-radius: 10px; font-weight: 600; transition: all 0.3s ease;">
                        ìì£¼ ë¬»ëŠ” ì§ˆë¬¸
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div class="footer" style="position: relative; margin-top: 0;">
        <p><strong>âš ï¸ ë©´ì±… ì¡°í•­:</strong> íŒë§¤ì  ë‹¹ì²¨ ì •ë³´ëŠ” ì°¸ê³ ìš©ì´ë©°, ë‹¹ì²¨ì„ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
        <p>
            <a href="privacy.html" style="color: white; text-decoration: underline;">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a> |
            <a href="about.html" style="color: white; text-decoration: underline;">ì„œë¹„ìŠ¤ ì†Œê°œ</a> |
            <a href="https://github.com/ocean-no1/jocoding/issues" target="_blank"
                style="color: white; text-decoration: underline;">ë¬¸ì˜í•˜ê¸°</a>
        </p>
        <p>Â© 2026 AI í†µê³„ ë¶„ì„ ì„œë¹„ìŠ¤</p>
    </div>
</body>

</html>