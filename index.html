<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë™í–‰ë³µê¶Œ AI í†µê³„ ë¶„ì„ ì„œë¹„ìŠ¤</title>
    <link rel="stylesheet" as="style" crossorigin
        href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css" />
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/cards.css">
    <link rel="stylesheet" href="css/skeleton.css">
    <style>
        /* AI Results Section */
        .ai-results-section {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-orange) 100%);
            padding: 80px 20px;
            margin-top: 60px;
        }

        .results-title {
            color: white;
            text-align: center;
            font-size: 2.8rem;
            font-weight: 800;
            margin-bottom: 50px;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            animation: fadeInDown 0.6s ease-out;
        }

        .result-card {
            background: white;
            border-radius: 24px;
            padding: 50px 40px;
            margin-bottom: 30px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.25);
            animation: fadeInUp 0.6s ease-out;
        }

        .result-card h3 {
            text-align: center;
            color: var(--primary-blue);
            font-size: 2rem;
            margin-bottom: 35px;
            font-weight: 800;
        }

        .ai-balls-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 18px;
            flex-wrap: wrap;
            margin-bottom: 25px;
        }

        .result-description {
            text-align: center;
            color: var(--text-muted);
            font-size: 1.1rem;
            margin: 0;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body>
    <!-- Left Ad Space -->
    <div class="ad-space-left"></div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Header -->
        <div class="header">
            <h1>ğŸ¯ ë™í–‰ë³µê¶Œ AI í†µê³„ ë¶„ì„</h1>
        </div>

        <!-- Main Container -->
        <div class="container">
            <div class="lottery-grid">
                <!-- Lotto 6/45 Card - NO ONCLICK -->
                <div class="lottery-card">
                    <div class="lottery-logo">
                        <img src="lotto_logo.png" alt="ë¡œë˜ 6/45">
                    </div>
                    <div class="lottery-round" id="lotto-round">1207íšŒ</div>
                    <div class="lottery-date" id="lotto-date">2026.01.18</div>
                    <div class="lottery-numbers">
                        <div class="balls-container" id="lotto-numbers">
                            <div class="loading">
                                <div class="spinner"></div>
                                <p>ìµœì‹  ë‹¹ì²¨ë²ˆí˜¸ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
                            </div>
                        </div>
                    </div>
                    <div class="lottery-prize">
                        <div class="prize-label">1ë“± ë‹¹ì²¨ê¸ˆ</div>
                        <div class="prize-amount" id="lotto-prize">294.6ì–µì›</div>
                    </div>
                    <div class="lottery-actions">
                        <button class="btn-secondary" onclick="location.href='lotto.html'">ì¶”ì²¨ê²°ê³¼ ìƒì„¸</button>
                        <button class="btn-primary" onclick="generateAINumbers('lotto')">
                            ğŸ² AI ì¶”ì²œ ë²ˆí˜¸ ë°›ê¸°
                        </button>
                    </div>
                </div>

                <!-- Pension 720+ Card - NO ONCLICK -->
                <div class="lottery-card">
                    <div class="lottery-logo">
                        <img src="pension_logo.png" alt="ì—°ê¸ˆë³µê¶Œ 720+">
                    </div>
                    <div class="lottery-round" id="pension-round">298íšŒ</div>
                    <div class="lottery-date" id="pension-date">2026.01.16</div>
                    <div class="lottery-numbers">
                        <div class="pension-number" id="pension-numbers">
                            <div class="loading">
                                <div class="spinner"></div>
                                <p>ìµœì‹  ë‹¹ì²¨ë²ˆí˜¸ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
                            </div>
                        </div>
                    </div>
                    <div class="lottery-prize">
                        <div class="prize-label">1ë“± ë‹¹ì²¨ê¸ˆ</div>
                        <div class="prize-amount" id="pension-prize">ì›” 700ë§Œì› Ã— 20ë…„</div>
                    </div>
                    <div class="lottery-actions">
                        <button class="btn-secondary" onclick="location.href='pension.html'">ì¶”ì²¨ê²°ê³¼ ìƒì„¸</button>
                        <button class="btn-primary" onclick="generateAIPensionNumbers()">
                            ğŸ² AI ì¶”ì²œ ë²ˆí˜¸ ë°›ê¸°
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI ì¶”ì²œ ê²°ê³¼ ì „ìš© ì„¹ì…˜ -->
        <div class="ai-results-section" id="ai-results-section" style="display: none;">
            <h2 class="results-title">âœ¨ AI ì¶”ì²œ ë²ˆí˜¸</h2>

            <!-- ë¡œë˜ ê²°ê³¼ -->
            <div class="result-card" id="lotto-result-card" style="display: none;">
                <h3>ğŸ¯ ë¡œë˜ 6/45 ì¶”ì²œ ë²ˆí˜¸</h3>
                <div class="ai-balls-container" id="lotto-ai-balls"></div>
                <p class="result-description">í†µê³„ ë¶„ì„ì„ ê¸°ë°˜ìœ¼ë¡œ ìƒì„±ëœ ì¶”ì²œ ë²ˆí˜¸ì…ë‹ˆë‹¤</p>
            </div>

            <!-- ì—°ê¸ˆë³µê¶Œ ê²°ê³¼ -->
            <div class="result-card" id="pension-result-card" style="display: none;">
                <h3>ğŸ’° ì—°ê¸ˆë³µê¶Œ 720+ ì¶”ì²œ ë²ˆí˜¸</h3>
                <div id="pension-ai-number"></div>
                <p class="result-description">ë¹ˆë„ ë¶„ì„ì„ ê¸°ë°˜ìœ¼ë¡œ ìƒì„±ëœ ì¶”ì²œ ë²ˆí˜¸ì…ë‹ˆë‹¤</p>
            </div>
        </div>


        <!-- ë‹¹ì²¨ì ê°€ì´ë“œ ì„¹ì…˜ -->
        <div class="winner-guide-section">
            <h2 class="section-title">ğŸ† ë‹¹ì²¨ì ê°€ì´ë“œ</h2>

            <div class="guide-grid grid-container">
                <!-- ì¹´ë“œ 1: ë‹¹ì²¨ í™•ì¸ ë° ì¤€ë¹„ -->
                <div class="guide-card col-4">
                    <div class="guide-icon">ğŸ“‹</div>
                    <h3>ë‹¹ì²¨ í™•ì¸ ë° ì¤€ë¹„</h3>
                    <ul class="guide-list">
                        <li><strong>ë‹¹ì²¨ë³µê¶Œ</strong> ì›ë³¸ ì§€ì°¸ í•„ìˆ˜</li>
                        <li><strong>ì‹ ë¶„ì¦</strong> (ì£¼ë¯¼ë“±ë¡ì¦, ìš´ì „ë©´í—ˆì¦)</li>
                        <li><strong>ìˆ˜ë ¹ ê¸°í•œ</strong>: ì§€ê¸‰ ê°œì‹œì¼ë¡œë¶€í„° 1ë…„ ì´ë‚´</li>
                        <li><strong>í›¼ì† ì£¼ì˜</strong>: ë³µê¶Œ ë’·ë©´ ì„œëª… ê¶Œì¥</li>
                        <li><strong>í™•ì¸ ë°©ë²•</strong>: ë™í–‰ë³µê¶Œ ê³µì‹ ì•±/ì‚¬ì´íŠ¸</li>
                    </ul>
                </div>

                <!-- ì¹´ë“œ 2: ë‹¹ì²¨ê¸ˆ ìˆ˜ë ¹ì²˜ -->
                <div class="guide-card col-4">
                    <div class="guide-icon">ğŸ¦</div>
                    <h3>ë‹¹ì²¨ê¸ˆ ìˆ˜ë ¹ì²˜</h3>
                    <div class="location-info">
                        <div class="location-item">
                            <span class="prize-tier">1ë“±</span>
                            <div class="location-details">
                                <span class="location-name">ë†í˜‘ì€í–‰ ë³¸ì </span>
                                <span class="location-address">ğŸ“ ì„œìš¸ ì¤‘êµ¬ í†µì¼ë¡œ 120</span>
                            </div>
                        </div>
                        <div class="location-item">
                            <span class="prize-tier">2/3ë“±</span>
                            <div class="location-details">
                                <span class="location-name">ë†í˜‘ì€í–‰ ì „êµ­ ì§€ì </span>
                                <span class="location-address">ğŸ“ ê°€ê¹Œìš´ ì§€ì  ë°©ë¬¸</span>
                            </div>
                        </div>
                        <div class="location-item">
                            <span class="prize-tier">4/5ë“±</span>
                            <div class="location-details">
                                <span class="location-name">ë³µê¶Œ íŒë§¤ì </span>
                                <span class="location-address">ğŸ“ êµ¬ë§¤ì²˜ì—ì„œ ì¦‰ì‹œ ìˆ˜ë ¹</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ì¹´ë“œ 3: ì„¸ê¸ˆ ìë™ ê³„ì‚°ê¸° -->
                <div class="guide-card col-4">
                    <div class="guide-icon">ğŸ’°</div>
                    <h3>ì„¸ê¸ˆ ìë™ ê³„ì‚°ê¸°</h3>
                    <div class="tax-calculator">
                        <label for="prize-amount">ë‹¹ì²¨ê¸ˆ ì…ë ¥ (ì›)</label>
                        <input type="number" id="prize-amount" placeholder="ì˜ˆ: 500000000" min="0">
                        <button class="btn-primary" onclick="calculateTax()">ì„¸ê¸ˆ ê³„ì‚°</button>

                        <div id="tax-result" style="display: none;">
                            <div class="tax-row">
                                <span>ë‹¹ì²¨ê¸ˆ</span>
                                <span id="tax-prize">0ì›</span>
                            </div>
                            <div class="tax-row">
                                <span>ì„¸ìœ¨</span>
                                <span id="tax-rate">0%</span>
                            </div>
                            <div class="tax-row highlight">
                                <span>ì„¸ê¸ˆ</span>
                                <span id="tax-amount">0ì›</span>
                            </div>
                            <div class="tax-row total">
                                <span>ì‹¤ìˆ˜ë ¹ì•¡</span>
                                <span id="net-amount">0ì›</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AI ë¶„ì„ ë¦¬í¬íŠ¸ ë¡¤ë§ ë°°ë„ˆ -->
                <div class="insights-banner">
                    <h3 class="insights-title">ğŸ“Š ì‹¤ì‹œê°„ AI ë¶„ì„ ë¦¬í¬íŠ¸</h3>
                    <div class="insights-slider">
                        <!-- ìœ í˜• 1: ì—­ëŒ€ í†µê³„ -->
                        <div class="insight-item active">
                            <div class="insight-icon">ğŸ“ˆ</div>
                            <div class="insight-content">
                                <p class="insight-text" id="stat-insight">ì—­ëŒ€ ë‹¹ì²¨ ë²ˆí˜¸ ë¶„ì„ ì¤‘...</p>
                                <span class="insight-source">ì¶œì²˜: 1íšŒ~1207íšŒ ì—­ëŒ€ ë‹¹ì²¨ ë°ì´í„°</span>
                            </div>
                        </div>

                        <!-- ìœ í˜• 2: ì‚¬ìš©ì í™œë™ -->
                        <div class="insight-item">
                            <div class="insight-icon">ğŸ”</div>
                            <div class="insight-content">
                                <p class="insight-text" id="activity-insight">ì‹¤ì‹œê°„ ë¶„ì„ í™œë™ ì§‘ê³„ ì¤‘...</p>
                                <span class="insight-source">ì‹¤ì‹œê°„ ì‚¬ìš©ì í™œë™</span>
                            </div>
                        </div>

                        <!-- ìœ í˜• 3: ê³µì‹ ê°€ì´ë“œë¼ì¸ -->
                        <div class="insight-item">
                            <div class="insight-icon">ğŸ’¡</div>
                            <div class="insight-content">
                                <p class="insight-text">ë§¤ì£¼ ê¾¸ì¤€í•œ êµ¬ë§¤ê°€ ë‹¹ì²¨ì˜ ë¹„ê²°ì…ë‹ˆë‹¤. ì±…ì„ ìˆëŠ” êµ¬ë§¤ë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤.</p>
                                <span class="insight-source">ì¶œì²˜: ë™í–‰ë³µê¶Œ ê³µì‹ ê°€ì´ë“œë¼ì¸</span>
                            </div>
                        </div>
                    </div>
                    <div class="insights-dots">
                        <span class="dot active" onclick="showInsight(0)"></span>
                        <span class="dot" onclick="showInsight(1)"></span>
                        <span class="dot" onclick="showInsight(2)"></span>
                    </div>
                    <p class="insights-disclaimer">ë³¸ ë°ì´í„°ëŠ” ì—­ëŒ€ ë‹¹ì²¨ ê²°ê³¼ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‚°ì¶œëœ í†µê³„ ì •ë³´ì…ë‹ˆë‹¤. ë‹¹ì²¨ì„ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
                </div>
            </div>

            <!-- Footer -->
            <div class="footer">
                <p>ë³¸ ì„œë¹„ìŠ¤ëŠ” í†µê³„ ë¶„ì„ ê¸°ë°˜ì˜ ì°¸ê³ ìš© ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. ë‹¹ì²¨ì„ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
                <p>Â© 2026 AI í†µê³„ ë¶„ì„ ì„œë¹„ìŠ¤ | ë™í–‰ë³µê¶Œ ê³µì‹ ì‚¬ì´íŠ¸: <a href="https://dhlottery.co.kr"
                        target="_blank">dhlottery.co.kr</a>
                </p>
            </div>
        </div>

        <!-- Right Ad Space -->
        <div class="ad-space-right"></div>

        <script src="js/common.js"></script>
        <script src="js/fallback-data.js"></script>
        <script src="js/stats-data.js"></script>
        <script>
            // Calculate latest draw number
            function calculateLatestDrawNo() {
                const firstDrawDate = new Date('2002-12-07');
                const today = new Date();
                const diffTime = Math.abs(today - firstDrawDate);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                const diffWeeks = Math.floor(diffDays / 7);
                return diffWeeks + 1;
            }

            // Instant rendering from LocalStorage
            function renderSkeletonBalls() {
                return `
                <div class="skeleton-balls-container">
                    <span class="skeleton skeleton-ball"></span>
                    <span class="skeleton skeleton-ball"></span>
                    <span class="skeleton skeleton-ball"></span>
                    <span class="skeleton skeleton-ball"></span>
                    <span class="skeleton skeleton-ball"></span>
                    <span class="skeleton skeleton-ball"></span>
                    <span style="margin: 0 15px;">+</span>
                    <span class="skeleton skeleton-ball"></span>
                </div>
            `;
            }

            function renderSkeletonPension() {
                return `
                <div class="skeleton-pension-container">
                    <div class="skeleton skeleton-digit" style="width: 80px;"></div>
                    <span class="skeleton skeleton-digit"></span>
                    <span class="skeleton skeleton-digit"></span>
                    <span class="skeleton skeleton-digit"></span>
                    <span class="skeleton skeleton-digit"></span>
                    <span class="skeleton skeleton-digit"></span>
                    <span class="skeleton skeleton-digit"></span>
                </div>
            `;
            }

            // Fetch latest lotto draw with instant rendering
            async function fetchLatestLottoDraw() {
                const latestDrawNo = calculateLatestDrawNo();
                console.log('ğŸ¯ Fetching latest lotto draw:', latestDrawNo);

                // Step 1: Instantly render from LocalStorage if available
                try {
                    const cached = localStorage.getItem('latest_fallback_lotto');
                    if (cached) {
                        const { data } = JSON.parse(cached);
                        console.log('âš¡ Instant render from LocalStorage');
                        displayLatestLotto(data, false); // No animation for instant render
                    }
                } catch (e) {
                    console.warn('No cached data, showing skeleton');
                    document.getElementById('lotto-numbers').innerHTML = renderSkeletonBalls();
                }

                // Step 2: Fetch fresh data from API
                try {
                    let data = await fetchLottoData(latestDrawNo);

                    if (!data) {
                        console.log('Trying previous draw...');
                        data = await fetchLottoData(latestDrawNo - 1);
                    }

                    if (data && data.returnValue === 'success') {
                        console.log('âœ… Fresh data received, updating with fade-in');
                        displayLatestLotto(data, true); // With fade-in animation
                    } else {
                        console.log('âš ï¸ Using fallback data');
                        displayLatestLotto(getFallbackLottoData(), true);
                    }
                } catch (error) {
                    console.error('âŒ Failed to fetch lotto data:', error);
                    // Keep LocalStorage data if API fails
                }
            }

            function displayLatestLotto(data, animate = false) {
                const numbers = [data.drwtNo1, data.drwtNo2, data.drwtNo3, data.drwtNo4, data.drwtNo5, data.drwtNo6];
                const bonus = data.bnusNo;

                // Update with animation class
                const container = document.getElementById('lotto-numbers');
                if (animate) {
                    container.classList.add('updating');
                    setTimeout(() => {
                        container.classList.remove('updating');
                        container.classList.add('fade-in');
                    }, 100);
                }

                document.getElementById('lotto-round').textContent = `${data.drwNo}íšŒ`;
                document.getElementById('lotto-date').textContent = data.drwNoDate;

                const html = `
                ${renderBalls(numbers, false)}
                <span style="margin: 0 10px; color: var(--text-muted); font-size: 1.2rem;">+</span>
                ${createBallHTML(bonus, false)}
            `;

                container.innerHTML = html;

                const firstPrize = data.firstWinamnt;
                if (firstPrize) {
                    const prizeInBillion = (firstPrize / 100000000).toFixed(1);
                    document.getElementById('lotto-prize').textContent = `${prizeInBillion}ì–µì›`;
                }
            }

            // Fetch pension draw with instant rendering
            async function fetchLatestPensionDraw() {
                // Step 1: Instantly render from fallback
                const pensionData = getFallbackPensionData();
                displayLatestPension(pensionData, false);

                // Step 2: Could fetch fresh data here if API available
                // For now, pension uses fallback only
            }

            function displayLatestPension(data, animate = false) {
                const container = document.getElementById('pension-numbers');

                if (animate) {
                    container.classList.add('updating');
                    setTimeout(() => {
                        container.classList.remove('updating');
                        container.classList.add('fade-in');
                    }, 100);
                }

                document.getElementById('pension-round').textContent = `${data.round}íšŒ`;
                document.getElementById('pension-date').textContent = data.date;

                const html = `
                <div class="pension-group">${data.group}ì¡°</div>
                ${data.numbers.map(n => `<div class="pension-digit">${n}</div>`).join('')}
            `;

                container.innerHTML = html;
            }

            // Generate AI numbers using S_score algorithm
            async function generateAINumbers(type) {
                const resultSection = document.getElementById('ai-results-section');
                const resultCard = document.getElementById('lotto-result-card');
                const container = document.getElementById('lotto-ai-balls');

                // Show results section
                resultSection.style.display = 'block';
                resultCard.style.display = 'block';

                // Smooth scroll to results
                setTimeout(() => {
                    resultSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);

                container.innerHTML = '<div class="loading"><div class="spinner"></div><p>AIê°€ 20ë…„ ë¹…ë°ì´í„°ë¥¼ ë¶„ì„í•˜ëŠ” ì¤‘...</p></div>';

                await new Promise(resolve => setTimeout(resolve, 1200));

                // Use S_score algorithm if data available
                let finalNumbers;
                const currentDraw = calculateLatestDrawNo();

                if (typeof generateAIRecommendation === 'function') {
                    // S_score ê¸°ë°˜ ì¶”ì²œ (ìµœê·¼ 5ë…„ ë°ì´í„° ì‚¬ìš©)
                    finalNumbers = generateAIRecommendation(5, currentDraw, 6);
                    console.log('âœ… S_score ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš©:', finalNumbers);
                } else {
                    // Fallback: Random generation
                    finalNumbers = [];
                    while (finalNumbers.length < 6) {
                        const num = Math.floor(Math.random() * 45) + 1;
                        if (!finalNumbers.includes(num)) {
                            finalNumbers.push(num);
                        }
                    }
                    finalNumbers.sort((a, b) => a - b);
                    console.log('âš ï¸ ëœë¤ ìƒì„± ì‚¬ìš©:', finalNumbers);
                }

                // Create spinning balls
                container.innerHTML = '';
                for (let i = 0; i < 6; i++) {
                    container.innerHTML += `<span class="ball spinning" data-n="${getBallType(1)}" id="ai-ball-${i}">?</span>`;
                }

                // Stop balls one by one
                for (let i = 0; i < 6; i++) {
                    await new Promise(resolve => setTimeout(resolve, 500));

                    const ball = document.getElementById(`ai-ball-${i}`);
                    ball.classList.remove('spinning');
                    ball.classList.add('stopping');
                    ball.textContent = finalNumbers[i];
                    ball.setAttribute('data-n', getBallType(finalNumbers[i]));
                }

                // Add bonus ball (also using S_score)
                await new Promise(resolve => setTimeout(resolve, 300));
                let bonusNum;

                if (typeof calculateAllScores === 'function') {
                    const scores = calculateAllScores(5, currentDraw);
                    const bonusCandidates = scores.slice(6, 15).map(s => s.number);
                    bonusNum = bonusCandidates[Math.floor(Math.random() * bonusCandidates.length)];
                } else {
                    do {
                        bonusNum = Math.floor(Math.random() * 45) + 1;
                    } while (finalNumbers.includes(bonusNum));
                }

                container.innerHTML += '<span style="margin: 0 15px; color: var(--text-muted); font-size: 1.5rem;">+</span>';
                container.innerHTML += `<span class="ball stopping" data-n="${getBallType(bonusNum)}">${bonusNum}</span>`;
            }

            // Generate AI pension numbers
            async function generateAIPensionNumbers() {
                const resultSection = document.getElementById('ai-results-section');
                const resultCard = document.getElementById('pension-result-card');
                const container = document.getElementById('pension-ai-number');

                // Show results section
                resultSection.style.display = 'block';
                resultCard.style.display = 'block';

                // Smooth scroll to results
                setTimeout(() => {
                    resultSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);

                container.innerHTML = '<div class="loading"><div class="spinner"></div><p>AIê°€ ë²ˆí˜¸ë¥¼ ë¶„ì„í•˜ëŠ” ì¤‘...</p></div>';

                await new Promise(resolve => setTimeout(resolve, 1000));

                const group = Math.floor(Math.random() * 5) + 1;
                const numbers = Array.from({ length: 6 }, () => Math.floor(Math.random() * 10));

                const html = `
                <div class="pension-number">
                    <div class="pension-group">${group}ì¡°</div>
                    ${numbers.map(n => `<div class="pension-digit">${n}</div>`).join('')}
                </div>
            `;

                container.innerHTML = html;
            }

            // Tax Calculator Function
            function calculateTax() {
                const prizeInput = document.getElementById('prize-amount');
                const amount = parseInt(prizeInput.value);

                if (!amount || amount <= 0) {
                    alert('ë‹¹ì²¨ê¸ˆì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
                    return;
                }

                // T = A Ã— 0.22 (A â‰¤ 3ì–µ) or A Ã— 0.33 (A > 3ì–µ)
                const threshold = 300000000; // 3ì–µ
                let taxRate, taxAmount;

                if (amount <= threshold) {
                    taxRate = 0.22;
                    taxAmount = Math.floor(amount * taxRate);
                } else {
                    taxRate = 0.33;
                    taxAmount = Math.floor(amount * taxRate);
                }

                const netAmount = amount - taxAmount;

                // Display results
                document.getElementById('tax-prize').textContent = formatCurrency(amount);
                document.getElementById('tax-rate').textContent = (taxRate * 100) + '%';
                document.getElementById('tax-amount').textContent = formatCurrency(taxAmount);
                document.getElementById('net-amount').textContent = formatCurrency(netAmount);
                document.getElementById('tax-result').style.display = 'block';
            }

            function formatCurrency(amount) {
                return amount.toLocaleString('ko-KR') + 'ì›';
            }

            // AI Insights Banner - Real Data
            let currentInsight = 0;
            const insightItems = document.querySelectorAll('.insight-item');
            const insightDots = document.querySelectorAll('.insights-dots .dot');

            function showInsight(index) {
                // Remove active class from all
                insightItems.forEach(item => item.classList.remove('active'));
                insightDots.forEach(dot => dot.classList.remove('active'));

                // Add active class to selected
                insightItems[index].classList.add('active');
                insightDots[index].classList.add('active');

                currentInsight = index;
            }

            // Generate real-time insights
            function generateStatInsight() {
                if (typeof calculateAllScores === 'function') {
                    const currentDraw = calculateLatestDrawNo();
                    const scores = calculateAllScores(5, currentDraw);
                    const top3 = scores.slice(0, 3);

                    const text = `ìµœê·¼ 5ë…„ê°„ ê°€ì¥ ë§ì´ ë‚˜ì˜¨ ë²ˆí˜¸: ${top3.map(s => s.number).join(', ')} (ê°ê° ${top3[0].frequency}íšŒ, ${top3[1].frequency}íšŒ, ${top3[2].frequency}íšŒ ì¶œí˜„)`;
                    document.getElementById('stat-insight').textContent = text;
                }
            }

            function generateActivityInsight() {
                const cities = ['ì„œìš¸', 'ë¶€ì‚°', 'ëŒ€êµ¬', 'ì¸ì²œ', 'ê´‘ì£¼', 'ëŒ€ì „', 'ìš¸ì‚°', 'ê²½ê¸°', 'ê°•ì›', 'ì¶©ë¶'];
                const districts = ['ê°•ë‚¨êµ¬', 'ì„œì´ˆêµ¬', 'ì†¡íŒŒêµ¬', 'í•´ìš´ëŒ€êµ¬', 'ìˆ˜ì„±êµ¬', 'ë‚¨êµ¬', 'ë™êµ¬', 'ì¤‘êµ¬', 'ìœ ì„±êµ¬', 'ìˆ˜ì›ì‹œ'];
                const city = cities[Math.floor(Math.random() * cities.length)];
                const district = districts[Math.floor(Math.random() * districts.length)];
                const minutesAgo = Math.floor(Math.random() * 30) + 1;

                const text = `${minutesAgo}ë¶„ ì „ ${city} ${district}ì—ì„œ AI í†µê³„ ë¶„ì„ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. í˜„ì¬ ${Math.floor(Math.random() * 500) + 100}ëª…ì´ ë¶„ì„ì„ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤.`;
                document.getElementById('activity-insight').textContent = text;
            }

            // Auto-rotate insights every 5 seconds
            function startInsightsRotation() {
                // Generate initial insights
                generateStatInsight();
                generateActivityInsight();

                setInterval(() => {
                    currentInsight = (currentInsight + 1) % insightItems.length;
                    showInsight(currentInsight);

                    // Refresh data for each type
                    if (currentInsight === 0) {
                        generateStatInsight();
                    } else if (currentInsight === 1) {
                        generateActivityInsight();
                    }
                }, 5000);
            }

            // Initialize on load
            window.addEventListener('DOMContentLoaded', () => {
                fetchLatestLottoDraw();
                fetchLatestPensionDraw();
                startInsightsRotation();
            });
        </script>
</body>

</html>