<!DOCTYPE html>
<html lang="ko">

<head>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5482753613081557"
        crossorigin="anonymous"></script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì£¼ë³€ ëª…ë‹¹ ì°¾ê¸° - 1ë“± íŒë§¤ì  ì§€ë„</title>
    <meta name="description" content="ë‚´ ì£¼ë³€ì˜ ë¡œë˜ 1ë“± ë‹¹ì²¨ íŒë§¤ì ì„ ì§€ë„ì—ì„œ ì°¾ì•„ë³´ì„¸ìš”.">
    <link rel="stylesheet" as="style" crossorigin
        href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css" />
    <!-- Kakao Map API -->
    <script type="text/javascript"
        src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=8c78a44cbc45fec0aa35705516f1a082&libraries=services,clusterer,roadview"></script>

    <!-- Utility Scripts -->
    <script src="js/utils.js"></script>
    <script src="js/lotto-enhanced.js"></script>
    <style>
        .map-container {
            width: 100%;
            height: 100vh;
            position: relative;
        }

        #map {
            width: 100%;
            height: 100%;
        }

        .map-header {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            background: white;
            padding: 15px 30px;
            border-radius: 50px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .map-header h1 {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary-blue);
            margin: 0;
        }

        .search-box {
            position: absolute;
            top: 100px;
            left: 20px;
            z-index: 100;
            background: white;
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            width: 320px;
        }

        .search-input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            margin-bottom: 10px;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary-blue);
        }

        .search-btn {
            width: 100%;
            padding: 12px;
            background: var(--primary-blue);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .search-btn:hover {
            background: var(--primary-orange);
        }

        .my-location-btn {
            position: absolute;
            bottom: 120px;
            right: 20px;
            z-index: 100;
            width: 50px;
            height: 50px;
            background: white;
            border: none;
            border-radius: 50%;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .my-location-btn:hover {
            background: var(--primary-blue);
            color: white;
            transform: scale(1.1);
        }

        .store-info-box {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            background: white;
            padding: 20px 25px;
            border-radius: 16px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
            min-width: 350px;
            display: none;
        }

        .store-info-box.active {
            display: block;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                transform: translate(-50%, 100px);
                opacity: 0;
            }

            to {
                transform: translateX(-50%);
                opacity: 1;
            }
        }

        .store-name {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary-blue);
            margin-bottom: 8px;
        }

        .store-address {
            font-size: 0.95rem;
            color: var(--text-muted);
            margin-bottom: 12px;
        }

        .store-wins {
            display: flex;
            gap: 15px;
            margin-top: 12px;
        }

        .win-badge {
            padding: 8px 15px;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .win-badge.first {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            color: white;
        }

        .win-badge.second {
            background: linear-gradient(135deg, #C0C0C0 0%, #A8A8A8 100%);
            color: white;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--text-muted);
            cursor: pointer;
        }

        .back-button {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 100;
            padding: 12px 20px;
            background: white;
            border: 2px solid var(--primary-blue);
            color: var(--primary-blue);
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .back-button:hover {
            background: var(--primary-blue);
            color: white;
        }

        .legend {
            position: absolute;
            bottom: 20px;
            left: 20px;
            z-index: 100;
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .legend-title {
            font-size: 0.9rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 5px;
            font-size: 0.85rem;
        }

        .legend-marker {
            width: 20px;
            height: 20px;
            border-radius: 50%;
        }

        .marker-gold {
            background: #FFD700;
        }

        .marker-silver {
            background: #C0C0C0;
        }

        .marker-normal {
            background: #4A90E2;
        }

        #roadview {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 200;
            display: none;
        }

        .roadview-close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 201;
            padding: 12px 20px;
            background: white;
            border: 2px solid var(--primary-blue);
            color: var(--primary-blue);
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .roadview-close-btn:hover {
            background: var(--primary-blue);
            color: white;
        }

        @media (max-width: 768px) {
            .search-box {
                width: calc(100% - 40px);
                left: 20px;
                right: 20px;
            }

            .store-info-box {
                min-width: auto;
                width: calc(100% - 40px);
            }

            .map-header h1 {
                font-size: 1.1rem;
            }
        }
    </style>
</head>

<body>
    <div class="map-container">
        <a href="index.html" class="back-button">ğŸ  í™ˆìœ¼ë¡œ</a>

        <div class="map-header">
            <h1>ğŸ—ºï¸ ì£¼ë³€ ëª…ë‹¹ ì°¾ê¸°</h1>
        </div>

        <div class="search-box">
            <input type="text" class="search-input" id="search-input" placeholder="ì§€ì—­ëª… ì…ë ¥ (ì˜ˆ: ê°•ë‚¨êµ¬, ì‚¼ì„±ë™)"
                onkeypress="if(event.key === 'Enter') searchLocation()">
            <button class="search-btn" onclick="searchLocation()">ê²€ìƒ‰</button>
        </div>

        <button class="my-location-btn" onclick="goToMyLocation()" title="ë‚´ ìœ„ì¹˜ë¡œ ì´ë™">
            ğŸ“
        </button>

        <div class="legend">
            <div class="legend-title">ë²”ë¡€</div>
            <div class="legend-item">
                <div class="legend-marker marker-gold"></div>
                <span>1ë“± ë‹¹ì²¨ì  (3íšŒ ì´ìƒ)</span>
            </div>
            <div class="legend-item">
                <div class="legend-marker marker-silver"></div>
                <span>1ë“± ë‹¹ì²¨ì  (1-2íšŒ)</span>
            </div>
            <div class="legend-item">
                <div class="legend-marker marker-normal"></div>
                <span>ì¼ë°˜ íŒë§¤ì </span>
            </div>
        </div>

        <div id="map"></div>

        <!-- ë¡œë“œë·° ì»¨í…Œì´ë„ˆ -->
        <div id="roadview"></div>
        <button class="roadview-close-btn" id="roadview-close" onclick="closeRoadview()" style="display: none;">âœ• ë¡œë“œë·°
            ë‹«ê¸°</button>

        <!-- ë²”ë¡€ (í˜¸ê°±ë…¸ë…¸ ìŠ¤íƒ€ì¼) -->
        <div style="
            position: absolute;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            padding: 15px 25px;
            border-radius: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: flex;
            gap: 20px;
            align-items: center;
            z-index: 100;
        ">
            <div style="display: flex; align-items: center; gap: 8px;">
                <div
                    style="width: 40px; height: 24px; background: #FFD700; border-radius: 12px; text-align: center; color: #1F2937; font-size: 0.75rem; line-height: 24px; font-weight: 700; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    3+</div>
                <span style="font-size: 0.9rem; font-weight: 600; color: #1F2937;">1ë“± 3íšŒ ì´ìƒ ğŸ†</span>
            </div>
            <div style="display: flex; align-items: center; gap: 8px;">
                <div
                    style="width: 40px; height: 24px; background: #C0C0C0; border-radius: 12px; text-align: center; color: #1F2937; font-size: 0.75rem; line-height: 24px; font-weight: 700; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    1-2</div>
                <span style="font-size: 0.9rem; font-weight: 600; color: #1F2937;">1ë“± 1-2íšŒ ğŸ¥ˆ</span>
            </div>
            <div style="display: flex; align-items: center; gap: 8px;">
                <div
                    style="width: 40px; height: 24px; background: #A0A0A0; border-radius: 12px; text-align: center; color: white; font-size: 0.75rem; line-height: 24px; font-weight: 700;">
                    0</div>
                <span style="font-size: 0.9rem; font-weight: 600; color: #1F2937;">ì¼ë°˜ íŒë§¤ì </span>
            </div>
        </div>

        <div class="store-info-box" id="store-info">
            <button class="close-btn" onclick="closeStoreInfo()">âœ•</button>
            <div class="store-name" id="store-name">íŒë§¤ì  ì´ë¦„</div>
            <div class="store-address" id="store-address">ì£¼ì†Œ</div>
            <div class="store-wins" id="store-wins">
                <div class="win-badge first">1ë“± 3íšŒ</div>
                <div class="win-badge second">2ë“± 7íšŒ</div>
            </div>
        </div>
    </div>

    <script>
        // Google Sheets API URL (Apps Script Web App)
        const SHEETS_API_URL = 'https://script.google.com/macros/s/AKfycbztxG09bbt0mNRfErtMiNwtdL8jhXk-L_HPL9Enja-iAbse7YgAkHJKUnEGmO5vmUOQ/exec';

        // ì „ì—­ ë³€ìˆ˜
        let storeData = [];
        let map;
        let markers = [];
        let clusterer; // ë§ˆì»¤ í´ëŸ¬ìŠ¤í„°ëŸ¬

        // === Google Sheetsì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ===
        async function loadStoreData() {
            try {
                console.log('ë¡œë˜ ëª…ë‹¹ ë°ì´í„° ë¡œë”© ì¤‘...');
                const response = await fetch(SHEETS_API_URL);

                if (!response.ok) {
                    throw new Error('API ì‘ë‹µ ì‹¤íŒ¨');
                }

                storeData = await response.json();
                console.log('âœ… ë°ì´í„° ë¡œë“œ ì™„ë£Œ:', storeData.length, 'ê°œ íŒë§¤ì ');

                return storeData;
            } catch (error) {
                console.warn('âš ï¸ API ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨, Fallback ë°ì´í„° ì‚¬ìš©:', error);
                storeData = getFallbackData();
                return storeData;
            }
        }

        // === Fallback ë°ì´í„° (API ì‹¤íŒ¨ ì‹œ ì‚¬ìš©) ===
        function getFallbackData() {
            return [
                {
                    name: "ì‚¼ì„±ëŒ€ë°•ë³µê¶Œë°©",
                    address: "ì„œìš¸ ê°•ë‚¨êµ¬ ë´‰ì€ì‚¬ë¡œ74ê¸¸ 13 101í˜¸",
                    lat: 37.5089,
                    lng: 127.0533,
                    first: 3,
                    second: 7
                },
                {
                    name: "ë¡œë˜ë°±í™”ì ",
                    address: "ì„œìš¸ ì„œì´ˆêµ¬ ê°•ë‚¨ëŒ€ë¡œ 27",
                    lat: 37.5000,
                    lng: 127.0152,
                    first: 4,
                    second: 8
                },
                {
                    name: "í™©ê¸ˆì†ë³µê¶Œ",
                    address: "ì„œìš¸ ì†¡íŒŒêµ¬ ì˜¬ë¦¼í”½ë¡œ35ë‹¤ê¸¸ 42",
                    lat: 37.5144,
                    lng: 127.1060,
                    first: 2,
                    second: 4
                },
                {
                    name: "í–‰ìš´ë³µê¶Œë°©",
                    address: "ì„œìš¸ ì˜ë“±í¬êµ¬ ì—¬ì˜ëŒ€ë¡œ 108",
                    lat: 37.5219,
                    lng: 126.9245,
                    first: 1,
                    second: 3
                }
            ];
        }

        // ì§€ë„ ì´ˆê¸°í™” (Kakao API í‚¤ í•„ìš”)
        async function initMap() {
            // ë¨¼ì € ë°ì´í„° ë¡œë“œ
            await loadStoreData();

            // Kakao APIê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ì„ ê²½ìš°ë¥¼ ëŒ€ë¹„í•œ í´ë°±
            if (typeof kakao === 'undefined' || typeof kakao.maps === 'undefined') {
                console.error('Kakao Maps API not loaded');
                alert('ì§€ë„ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                showSimpleMap();
                return;
            }

            try {
                const container = document.getElementById('map');
                const options = {
                    center: new kakao.maps.LatLng(37.5089, 127.0533), // ì„œìš¸ ê°•ë‚¨
                    level: 5
                };

                map = new kakao.maps.Map(container, options);

                // íŒë§¤ì  ë§ˆì»¤ í‘œì‹œ
                displayStores();
            } catch (error) {
                console.error('Map initialization error:', error);
                alert('ì§€ë„ ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                showSimpleMap();
            }
        }

        // ê°„ë‹¨í•œ HTML ì§€ë„ (API ëŒ€ì²´ìš©)
        function showSimpleMap() {
            document.getElementById('map').innerHTML = `
                <div style="display: flex; flex-wrap: wrap; padding: 20px; gap: 15px; overflow-y: auto;">
                    ${storeData.map(store => `
                        <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); width: calc(50% - 10px); min-width: 280px;" onclick='showStoreInfo(${JSON.stringify(store)})'>
                            <div style="font-size: 1.2rem; font-weight: 700; color: #1E3A8A; margin-bottom: 8px;">${store.name}</div>
                            <div style="font-size: 0.9rem; color: #64748B; margin-bottom: 12px;">${store.address}</div>
                            <div style="display: flex; gap: 10px;">
                                ${store.first > 0 ? `<span style="background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%); color: white; padding: 6px 12px; border-radius: 6px; font-size: 0.85rem; font-weight: 600;">1ë“± ${store.first}íšŒ</span>` : ''}
                                ${store.second > 0 ? `<span style="background: linear-gradient(135deg, #C0C0C0 0%, #A8A8A8 100%); color: white; padding: 6px 12px; border-radius: 6px; font-size: 0.85rem; font-weight: 600;">2ë“± ${store.second}íšŒ</span>` : ''}
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function displayStores() {
            // í´ëŸ¬ìŠ¤í„°ëŸ¬ ì´ˆê¸°í™”
            clusterer = new kakao.maps.MarkerClusterer({
                map: map,
                averageCenter: true,
                minLevel: 6, // ìµœì†Œ ë ˆë²¨ (6 ì´ìƒì—ì„œ í´ëŸ¬ìŠ¤í„°ë§)
                disableClickZoom: false, // í´ë¦­ ì‹œ ì¤Œ
                styles: [{
                    width: '53px',
                    height: '52px',
                    background: 'rgba(255, 215, 0, 0.9)',
                    borderRadius: '25px',
                    color: '#1F2937',
                    textAlign: 'center',
                    fontWeight: 'bold',
                    lineHeight: '52px',
                    fontSize: '14px'
                }]
            });

            storeData.forEach(store => {
                const markerPosition = new kakao.maps.LatLng(store.lat, store.lng);

                // ë‹¹ì²¨ íšŸìˆ˜ì— ë”°ë¼ ë§ˆì»¤ ìƒ‰ìƒ ê²°ì •
                let balloonColor;
                if (store.first >= 3) {
                    balloonColor = '#FFD700'; // ê¸ˆìƒ‰
                } else if (store.first >= 1) {
                    balloonColor = '#C0C0C0'; // ì€ìƒ‰
                } else {
                    balloonColor = '#A0A0A0'; // íšŒìƒ‰
                }

                // SVG ë§ˆì»¤ ì´ë¯¸ì§€ ìƒì„± (í˜¸ê°±ë…¸ë…¸ ìŠ¤íƒ€ì¼)
                const svgMarker = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="50" height="30" viewBox="0 0 50 30">
                        <rect x="0" y="0" width="50" height="30" rx="15" ry="15" 
                              fill="${balloonColor}" 
                              stroke="#000" 
                              stroke-width="0.5" 
                              opacity="0.95"/>
                        <text x="25" y="20" 
                              font-family="Pretendard, sans-serif" 
                              font-size="13" 
                              font-weight="700" 
                              fill="#fff" 
                              text-anchor="middle">${store.first || 0}íšŒ</text>
                    </svg>
                `;

                const markerImage = new kakao.maps.MarkerImage(
                    'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(svgMarker),
                    new kakao.maps.Size(50, 30),
                    { offset: new kakao.maps.Point(25, 15) }
                );

                // ë§ˆì»¤ ìƒì„±
                const marker = new kakao.maps.Marker({
                    position: markerPosition,
                    image: markerImage,
                    clickable: true
                });

                // ë§ˆì»¤ì— íŒë§¤ì  ì •ë³´ ì €ì¥
                marker.storeInfo = store;

                // í´ë¦­ ì´ë²¤íŠ¸
                kakao.maps.event.addListener(marker, 'click', function () {
                    showStoreInfoOnMap(marker.storeInfo);
                });

                markers.push(marker);
            });

            // í´ëŸ¬ìŠ¤í„°ëŸ¬ì— ë§ˆì»¤ ì¶”ê°€
            clusterer.addMarkers(markers);
        }

        function createMarkerImage(color) {
            const imageSrc = `data:image/svg+xml,%3Csvg width='30' height='40' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M15 0C6.7 0 0 6.7 0 15c0 11.25 15 25 15 25s15-13.75 15-25c0-8.3-6.7-15-15-15z' fill='${encodeURIComponent(color)}'/%3E%3Ccircle cx='15' cy='15' r='8' fill='white'/%3E%3C/svg%3E`;
            const imageSize = new kakao.maps.Size(30, 40);
            const imageOption = { offset: new kakao.maps.Point(15, 40) };

            return new kakao.maps.MarkerImage(imageSrc, imageSize, imageOption);
        }

        // í˜„ì¬ ì—´ë ¤ìˆëŠ” ì¸í¬ìœˆë„ìš°ë¥¼ ì €ì¥í•  ë³€ìˆ˜
        let currentInfoWindow = null;

        function showStoreInfoOnMap(store) {
            // í•˜ë‹¨ íŒ¨ë„ ì—…ë°ì´íŠ¸ (ê¸°ì¡´ ê¸°ëŠ¥ ìœ ì§€)
            document.getElementById('store-name').textContent = store.name;
            document.getElementById('store-address').textContent = store.address;

            let winsHTML = '';
            if (store.first > 0) {
                winsHTML += `<div class="win-badge first">1ë“± ${store.first}íšŒ</div>`;
            }
            if (store.second > 0) {
                winsHTML += `<div class="win-badge second">2ë“± ${store.second}íšŒ</div>`;
            }
            if (store.first === 0 && store.second === 0) {
                winsHTML = '<div style="color: #64748B;">ë‹¹ì²¨ ì´ë ¥ ì§‘ê³„ ì¤‘</div>';
            }

            document.getElementById('store-wins').innerHTML = winsHTML;
            document.getElementById('store-info').classList.add('active');

            // === íŒì—… (InfoWindow) ê¸°ëŠ¥ ì¶”ê°€ ===

            // ê¸°ì¡´ ì¸í¬ìœˆë„ìš°ê°€ ìˆë‹¤ë©´ ë‹«ê¸°
            if (currentInfoWindow) {
                currentInfoWindow.close();
            }

            // ì¸í¬ìœˆë„ìš° ë‚´ìš© (ë¡œë“œë·°, ê¸¸ì°¾ê¸° ë§í¬ í¬í•¨)
            const iwContent = `
                <div style="padding:15px; min-width:220px;">
                    <h4 style="margin:0 0 5px 0; font-size:16px; font-weight:bold; color:#1E3A8A;">${store.name}</h4>
                    <div style="font-size:12px; color:#555; margin-bottom:10px;">${store.address}</div>
                    <div style="display:flex; justify-content:space-between; font-size:12px;">
                        <button onclick="showRoadview(${store.lat}, ${store.lng})" style="
                            text-decoration:none; 
                            background:#FEE500; 
                            color:#191919; 
                            padding:5px 10px; 
                            border:none;
                            border-radius:4px; 
                            font-weight:bold;
                            cursor:pointer;
                            display:flex; align-items:center; gap:3px;">
                            ğŸ“· ë¡œë“œë·° ë³´ê¸°
                        </button>
                        <a href="https://map.kakao.com/link/to/${store.name},${store.lat},${store.lng}" target="_blank" style="
                            text-decoration:none; 
                            background:#3B82F6; 
                            color:white; 
                            padding:5px 10px; 
                            border-radius:4px; 
                            font-weight:bold;
                            display:flex; align-items:center; gap:3px;">
                            ğŸš— ê¸¸ì°¾ê¸°
                        </a>
                    </div>
                </div>
            `;

            // ì¸í¬ìœˆë„ìš° ìœ„ì¹˜ (ë§ˆì»¤ë³´ë‹¤ ì‚´ì§ ìœ„)
            const iwPosition = new kakao.maps.LatLng(store.lat, store.lng);

            // ì¸í¬ìœˆë„ìš° ìƒì„±
            const infowindow = new kakao.maps.InfoWindow({
                position: iwPosition,
                content: iwContent,
                removable: true // ë‹«ê¸° ë²„íŠ¼ í‘œì‹œ
            });

            // ì§€ë„ì— ì—´ê¸°
            infowindow.open(map);
            currentInfoWindow = infowindow;

            // ì§€ë„ ì¤‘ì‹¬ ì´ë™ (ì„ íƒì‚¬í•­, ëª¨ë°”ì¼ì—ì„œ ìœ ìš©)
            // map.panTo(iwPosition);
        }

        function showStoreInfo(store) {
            showStoreInfoOnMap(store);
        }

        function closeStoreInfo() {
            document.getElementById('store-info').classList.remove('active');
        }

        function searchLocation() {
            const query = document.getElementById('search-input').value;
            if (!query) {
                alert('ê²€ìƒ‰í•  ì§€ì—­ëª…ì„ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }

            // lotto-enhanced.jsì˜ searchAndMove í•¨ìˆ˜ ì‚¬ìš©
            if (typeof searchAndMove === 'function') {
                searchAndMove(query, map, markers, storeData);
            } else {
                alert('ê²€ìƒ‰ ê¸°ëŠ¥ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
            }
        }

        function goToMyLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition((position) => {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;

                    if (typeof kakao !== 'undefined' && map) {
                        const moveLatLon = new kakao.maps.LatLng(lat, lng);
                        map.setCenter(moveLatLon);
                    } else {
                        alert(`ë‚´ ìœ„ì¹˜: ${lat.toFixed(4)}, ${lng.toFixed(4)}\nì§€ë„ API ì—°ë™ í›„ ìœ„ì¹˜ ì´ë™ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.`);
                    }
                }, () => {
                    alert('ìœ„ì¹˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                });
            } else {
                alert('ì´ ë¸Œë¼ìš°ì €ëŠ” ìœ„ì¹˜ ì„œë¹„ìŠ¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
            }
        }

        // ë¡œë“œë·° í‘œì‹œ í•¨ìˆ˜
        function showRoadview(lat, lng) {
            if (typeof initRoadview === 'function') {
                initRoadview(lat, lng);
                document.getElementById('roadview-close').style.display = 'block';
            } else {
                alert('ë¡œë“œë·° ê¸°ëŠ¥ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
            }
        }

        // ë¡œë“œë·° ë‹«ê¸° í•¨ìˆ˜
        function closeRoadview() {
            document.getElementById('roadview').style.display = 'none';
            document.getElementById('roadview-close').style.display = 'none';
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì§€ë„ ì´ˆê¸°í™”
        window.onload = function () {
            initMap();
        };
    </script>

    <div class="footer" style="position: relative; margin-top: 0;">
        <p><strong>âš ï¸ ë©´ì±… ì¡°í•­:</strong> íŒë§¤ì  ë‹¹ì²¨ ì •ë³´ëŠ” ì°¸ê³ ìš©ì´ë©°, ë‹¹ì²¨ì„ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
        <p>
            <a href="privacy.html" style="color: white; text-decoration: underline;">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a> |
            <a href="about.html" style="color: white; text-decoration: underline;">ì„œë¹„ìŠ¤ ì†Œê°œ</a> |
            <a href="https://github.com/ocean-no1/jocoding/issues" target="_blank"
                style="color: white; text-decoration: underline;">ë¬¸ì˜í•˜ê¸°</a>
        </p>
        <p>Â© 2026 AI í†µê³„ ë¶„ì„ ì„œë¹„ìŠ¤</p>
    </div>
</body>

</html>